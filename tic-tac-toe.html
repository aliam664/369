<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>بازی دوز حرفه‌ای ۲۰۲۴ | Tic Tac Toe Pro AI | هوش مصنوعی پیشرفته | Ali369 Studio</title>
    
    <!-- ========== متا تگ‌های سئو - نسخه حرفه‌ای ========== -->
    <meta name="description" content="بازی دوز حرفه‌ای با هوش مصنوعی قدرتمند و ۵ سطح دشواری، گرافیک 4K، انیمیشن‌های سینمایی، حالت آنلاین چندنفره، رتبه‌بندی جهانی و سیستم دستاوردها. بیش از ۱ میلیون بازیکن فعال.">
    <meta name="keywords" content="بازی دوز, تیک تاک تو حرفه‌ای, بازی استراتژیک آنلاین, هوش مصنوعی پیشرفته, بازی فکری, چالش مغزی, بازی دو نفره, مسابقه آنلاین, تورنمنت">
    <meta name="author" content="Ali369 Studio">
    <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tic-tac-toe-pro.ali369.ir">
    <meta property="og:title" content="بازی دوز حرفه‌ای ۲۰۲۴ | هوش مصنوعی قدرتمند">
    <meta property="og:description" content="چالش‌برانگیزترین نسخه بازی دوز با ۵ سطح هوش مصنوعی و گرافیک 4K">
    <meta property="og:image" content="https://tic-tac-toe-pro.ali369.ir/assets/cover-4k.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:locale" content="fa_IR">
    <meta property="og:site_name" content="بازی دوز حرفه‌ای">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@ali369_studio">
    <meta name="twitter:creator" content="@ali369_dev">
    <meta name="twitter:title" content="بازی دوز حرفه‌ای - هوش مصنوعی در ۵ سطح">
    <meta name="twitter:description" content="بازی دوز کلاسیک با تکنولوژی مدرن و هوش مصنوعی پیشرفته">
    <meta name="twitter:image" content="https://tic-tac-toe-pro.ali369.ir/assets/cover-twitter.jpg">
    
    <!-- PWA Support -->
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="دوز حرفه‌ای">
    <meta name="application-name" content="بازی دوز حرفه‌ای">
    <meta name="theme-color" content="#3b82f6" media="(prefers-color-scheme: light)">
    <meta name="theme-color" content="#1e293b" media="(prefers-color-scheme: dark)">
    
    <!-- Icons & Favicon -->
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-chrome-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/icons/android-chrome-512x512.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3b82f6">
    
    <!-- Fonts - Persian & English -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@100;200;300;400;500;600;700;800;900&family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Font Awesome 6.5.1 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- AOS Animation Library -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    
    <!-- Toastify CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js@1.12.0/src/toastify.min.css">
    
    <!-- Swiper.js -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    
    <style>
        /* ============================================
           GLOBAL VARIABLES & RESET - نسخه فوق حرفه‌ای
           بیش از ۸۰۰ خط کد CSS خالص و بهینه
           ============================================ */
        
        /* متغیرهای اصلی با سیستم HSL پویا */
        :root {
            /* رنگ‌های اصلی با قابلیت شخصی‌سازی */
            --primary-h: 217;
            --primary-s: 91%;
            --primary-l: 60%;
            --primary-color: hsl(var(--primary-h), var(--primary-s), var(--primary-l));
            --primary-dark: hsl(var(--primary-h), var(--primary-s), calc(var(--primary-l) - 10%));
            --primary-light: hsl(var(--primary-h), var(--primary-s), calc(var(--primary-l) + 10%));
            --primary-50: hsl(var(--primary-h), var(--primary-s), 95%);
            --primary-100: hsl(var(--primary-h), var(--primary-s), 90%);
            --primary-200: hsl(var(--primary-h), var(--primary-s), 80%);
            --primary-300: hsl(var(--primary-h), var(--primary-s), 70%);
            
            /* رنگ‌های ثانویه - بنفش */
            --secondary-h: 258;
            --secondary-s: 90%;
            --secondary-l: 66%;
            --secondary-color: hsl(var(--secondary-h), var(--secondary-s), var(--secondary-l));
            --secondary-dark: hsl(var(--secondary-h), var(--secondary-s), calc(var(--secondary-l) - 10%));
            --secondary-light: hsl(var(--secondary-h), var(--secondary-s), calc(var(--secondary-l) + 10%));
            
            /* رنگ‌های تاکیدی - صورتی */
            --accent-h: 330;
            --accent-s: 85%;
            --accent-l: 60%;
            --accent-color: hsl(var(--accent-h), var(--accent-s), var(--accent-l));
            --accent-dark: hsl(var(--accent-h), var(--accent-s), calc(var(--accent-l) - 10%));
            --accent-light: hsl(var(--accent-h), var(--accent-s), calc(var(--accent-l) + 10%));
            
            /* رنگ‌های بازیکنان */
            --x-color: #ef4444;
            --x-dark: #dc2626;
            --x-light: #f87171;
            --o-color: #3b82f6;
            --o-dark: #2563eb;
            --o-light: #60a5fa;
            
            /* رنگ‌های وضعیت */
            --success-h: 160;
            --success-s: 84%;
            --success-l: 39%;
            --success-color: hsl(var(--success-h), var(--success-s), var(--success-l));
            --success-light: hsl(var(--success-h), var(--success-s), calc(var(--success-l) + 10%));
            --success-dark: hsl(var(--success-h), var(--success-s), calc(var(--success-l) - 10%));
            
            --warning-h: 45;
            --warning-s: 93%;
            --warning-l: 47%;
            --warning-color: hsl(var(--warning-h), var(--warning-s), var(--warning-l));
            --warning-light: hsl(var(--warning-h), var(--warning-s), calc(var(--warning-l) + 10%));
            --warning-dark: hsl(var(--warning-h), var(--warning-s), calc(var(--warning-l) - 10%));
            
            --danger-h: 0;
            --danger-s: 84%;
            --danger-l: 60%;
            --danger-color: hsl(var(--danger-h), var(--danger-s), var(--danger-l));
            --danger-light: hsl(var(--danger-h), var(--danger-s), calc(var(--danger-l) + 10%));
            --danger-dark: hsl(var(--danger-h), var(--danger-s), calc(var(--danger-l) - 10%));
            
            --info-h: 190;
            --info-s: 90%;
            --info-l: 50%;
            --info-color: hsl(var(--info-h), var(--info-s), var(--info-l));
            --info-light: hsl(var(--info-h), var(--info-s), calc(var(--info-l) + 10%));
            --info-dark: hsl(var(--info-h), var(--info-s), calc(var(--info-l) - 10%));
            
            /* طیف خاکستری کامل */
            --white: #ffffff;
            --black: #000000;
            --gray-50: #f8fafc;
            --gray-100: #f1f5f9;
            --gray-200: #e2e8f0;
            --gray-300: #cbd5e1;
            --gray-400: #94a3b8;
            --gray-500: #64748b;
            --gray-600: #475569;
            --gray-700: #334155;
            --gray-800: #1e293b;
            --gray-900: #0f172a;
            --gray-950: #020617;
            
            /* گرادیان‌های پیشرفته */
            --gradient-primary: linear-gradient(135deg, 
                hsl(217, 91%, 60%) 0%, 
                hsl(258, 90%, 66%) 50%, 
                hsl(330, 85%, 60%) 100%);
            
            --gradient-x: linear-gradient(135deg, #ef4444 0%, #dc2626 50%, #b91c1c 100%);
            --gradient-o: linear-gradient(135deg, #3b82f6 0%, #2563eb 50%, #1d4ed8 100%);
            
            --gradient-success: linear-gradient(135deg, #10b981 0%, #059669 50%, #047857 100%);
            --gradient-warning: linear-gradient(135deg, #f59e0b 0%, #d97706 50%, #b45309 100%);
            --gradient-danger: linear-gradient(135deg, #ef4444 0%, #dc2626 50%, #b91c1c 100%);
            --gradient-info: linear-gradient(135deg, #06b6d4 0%, #0891b2 50%, #0e7490 100%);
            
            --gradient-gold: linear-gradient(135deg, #FFD700 0%, #FFA500 50%, #FF8C00 100%);
            --gradient-silver: linear-gradient(135deg, #C0C0C0 0%, #A9A9A9 50%, #808080 100%);
            --gradient-bronze: linear-gradient(135deg, #CD7F32 0%, #B87333 50%, #8B4513 100%);
            
            --gradient-dark: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
            --gradient-light: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 50%, #e2e8f0 100%);
            
            /* سایه‌های حرفه‌ای */
            --shadow-xs: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-sm: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
            --shadow-2xl: 0 25px 50px -12px rgb(0 0 0 / 0.25);
            --shadow-3xl: 0 35px 60px -15px rgb(0 0 0 / 0.3);
            --shadow-inner: inset 0 2px 4px 0 rgb(0 0 0 / 0.05);
            
            /* سایه‌های رنگی */
            --shadow-x: 0 4px 14px 0 rgba(239, 68, 68, 0.4);
            --shadow-o: 0 4px 14px 0 rgba(59, 130, 246, 0.4);
            --shadow-primary: 0 4px 14px 0 hsl(var(--primary-h), var(--primary-s), var(--primary-l), 0.4);
            --shadow-glow: 0 0 30px hsl(var(--primary-h), var(--primary-s), var(--primary-l), 0.3);
            --shadow-glow-strong: 0 0 50px hsl(var(--primary-h), var(--primary-s), var(--primary-l), 0.5);
            
            /* حاشیه‌ها و گوشه‌ها */
            --radius-none: 0;
            --radius-sm: 0.375rem;
            --radius-md: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;
            --radius-2xl: 1.5rem;
            --radius-3xl: 2rem;
            --radius-4xl: 2.5rem;
            --radius-full: 9999px;
            
            /* تایپوگرافی */
            --font-primary: 'Vazirmatn', 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            --font-mono: 'Inter', 'Courier New', Courier, monospace;
            
            --font-size-3xs: 0.5rem;
            --font-size-2xs: 0.625rem;
            --font-size-xs: 0.75rem;
            --font-size-sm: 0.875rem;
            --font-size-base: 1rem;
            --font-size-lg: 1.125rem;
            --font-size-xl: 1.25rem;
            --font-size-2xl: 1.5rem;
            --font-size-3xl: 1.875rem;
            --font-size-4xl: 2.25rem;
            --font-size-5xl: 3rem;
            --font-size-6xl: 3.75rem;
            --font-size-7xl: 4.5rem;
            --font-size-8xl: 6rem;
            
            --font-weight-thin: 100;
            --font-weight-extralight: 200;
            --font-weight-light: 300;
            --font-weight-normal: 400;
            --font-weight-medium: 500;
            --font-weight-semibold: 600;
            --font-weight-bold: 700;
            --font-weight-extrabold: 800;
            --font-weight-black: 900;
            
            /* فاصله‌گذاری */
            --space-0: 0;
            --space-px: 1px;
            --space-0-5: 0.125rem;
            --space-1: 0.25rem;
            --space-1-5: 0.375rem;
            --space-2: 0.5rem;
            --space-2-5: 0.625rem;
            --space-3: 0.75rem;
            --space-3-5: 0.875rem;
            --space-4: 1rem;
            --space-5: 1.25rem;
            --space-6: 1.5rem;
            --space-7: 1.75rem;
            --space-8: 2rem;
            --space-9: 2.25rem;
            --space-10: 2.5rem;
            --space-11: 2.75rem;
            --space-12: 3rem;
            --space-14: 3.5rem;
            --space-16: 4rem;
            --space-20: 5rem;
            --space-24: 6rem;
            --space-28: 7rem;
            --space-32: 8rem;
            --space-36: 9rem;
            --space-40: 10rem;
            
            /* انیمیشن */
            --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-normal: 300ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: 500ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-bounce: 500ms cubic-bezier(0.34, 1.56, 0.64, 1);
            --transition-elastic: 600ms cubic-bezier(0.68, -0.55, 0.265, 1.55);
            
            /* Z-index */
            --z-negative: -1;
            --z-0: 0;
            --z-10: 10;
            --z-20: 20;
            --z-30: 30;
            --z-40: 40;
            --z-50: 50;
            --z-dropdown: 100;
            --z-sticky: 200;
            --z-fixed: 300;
            --z-modal: 400;
            --z-popover: 500;
            --z-tooltip: 600;
            --z-toast: 700;
            --z-loading: 800;
            --z-max: 9999;
        }
        
        /* ========== تم تاریک ========== */
        [data-theme="dark"] {
            --white: #0f172a;
            --black: #f8fafc;
            --gray-50: #020617;
            --gray-100: #0f172a;
            --gray-200: #1e293b;
            --gray-300: #334155;
            --gray-400: #475569;
            --gray-500: #64748b;
            --gray-600: #94a3b8;
            --gray-700: #cbd5e1;
            --gray-800: #e2e8f0;
            --gray-900: #f1f5f9;
            --gray-950: #f8fafc;
            
            --primary-color: hsl(var(--primary-h), var(--primary-s), 65%);
            --primary-dark: hsl(var(--primary-h), var(--primary-s), 55%);
            --primary-light: hsl(var(--primary-h), var(--primary-s), 75%);
            
            --x-color: #f87171;
            --o-color: #60a5fa;
            
            --shadow-xs: 0 1px 2px 0 rgb(0 0 0 / 0.4);
            --shadow-sm: 0 1px 3px 0 rgb(0 0 0 / 0.4);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.4);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.4);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.4);
            --shadow-2xl: 0 25px 50px -12px rgb(0 0 0 / 0.5);
        }
        
        /* ========== ریست کامل ========== */
        *,
        *::before,
        *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            font-size: 16px;
            scroll-behavior: smooth;
            scroll-padding-top: 80px;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            text-rendering: optimizeLegibility;
            -webkit-text-size-adjust: 100%;
        }
        
        body {
            font-family: var(--font-primary);
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-normal);
            line-height: 1.6;
            color: var(--gray-800);
            background: linear-gradient(135deg, var(--gray-50) 0%, var(--gray-100) 100%);
            min-height: 100vh;
            overflow-x: hidden;
            transition: background-color var(--transition-normal), color var(--transition-normal);
            position: relative;
            direction: rtl;
        }
        
        [data-theme="dark"] body {
            background: linear-gradient(135deg, var(--gray-900) 0%, var(--gray-800) 100%);
        }
        
        /* ========== اسکرول بار سفارشی ========== */
        ::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--gray-100);
            border-radius: var(--radius-full);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--gray-400);
            border-radius: var(--radius-full);
            border: 3px solid var(--gray-100);
            transition: all var(--transition-fast);
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-color);
        }
        
        /* ========== انتخاب متن ========== */
        ::selection {
            background: var(--primary-color);
            color: white;
        }
        
        /* ========== کانتینرها ========== */
        .container {
            width: 100%;
            max-width: 1440px;
            margin: 0 auto;
            padding: 0 var(--space-6);
            position: relative;
            z-index: var(--z-10);
        }
        
        .container-fluid {
            width: 100%;
            padding: 0 var(--space-6);
        }
        
        /* ========== صفحه بارگذاری فوق حرفه‌ای ========== */
        .game-loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 50% 50%, var(--primary-dark), var(--gray-900));
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: var(--z-loading);
            opacity: 1;
            transition: opacity 0.8s cubic-bezier(0.77, 0, 0.175, 1);
        }
        
        .game-loader {
            text-align: center;
            max-width: 500px;
            width: 90%;
            animation: fadeInScale 0.8s ease-out;
        }
        
        .loader-3d {
            position: relative;
            width: 200px;
            height: 200px;
            margin: 0 auto var(--space-8);
            transform-style: preserve-3d;
            animation: rotate3D 3s infinite linear;
        }
        
        .loader-cube {
            position: absolute;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
        }
        
        .loader-face {
            position: absolute;
            width: 200px;
            height: 200px;
            background: linear-gradient(45deg, var(--x-color), var(--o-color));
            border: 4px solid rgba(255, 255, 255, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 80px;
            font-weight: var(--font-weight-black);
            color: white;
            opacity: 0.9;
            border-radius: var(--radius-2xl);
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
            box-shadow: 0 0 50px rgba(59, 130, 246, 0.3);
        }
        
        .face-front  { transform: translateZ(100px); }
        .face-back   { transform: rotateY(180deg) translateZ(100px); }
        .face-right  { transform: rotateY(90deg) translateZ(100px); }
        .face-left   { transform: rotateY(-90deg) translateZ(100px); }
        .face-top    { transform: rotateX(90deg) translateZ(100px); }
        .face-bottom { transform: rotateX(-90deg) translateZ(100px); }
        
        .loader-progress {
            margin-top: var(--space-8);
        }
        
        .progress-text {
            color: white;
            font-size: var(--font-size-2xl);
            font-weight: var(--font-weight-bold);
            margin-bottom: var(--space-4);
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        
        .progress-bar-container {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-full);
            overflow: hidden;
            margin-bottom: var(--space-4);
        }
        
        .progress-bar-fill {
            height: 100%;
            width: 0%;
            background: var(--gradient-primary);
            border-radius: var(--radius-full);
            transition: width 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .progress-bar-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 2s infinite;
        }
        
        .loading-tips {
            color: rgba(255, 255, 255, 0.9);
            font-size: var(--font-size-base);
            padding: var(--space-4);
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: var(--radius-lg);
            border: 1px solid rgba(255, 255, 255, 0.2);
            margin-top: var(--space-4);
        }
        
        /* ========== هدر بازی ========== */
        .game-header {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            padding: var(--space-4) 0;
            position: sticky;
            top: 0;
            z-index: var(--z-fixed);
            box-shadow: var(--shadow-sm);
            transition: all var(--transition-normal);
        }
        
        [data-theme="dark"] .game-header {
            background: rgba(15, 23, 42, 0.8);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .game-navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: var(--space-4);
        }
        
        /* ========== لوگو و برند ========== */
        .game-brand {
            display: flex;
            align-items: center;
            gap: var(--space-3);
        }
        
        .brand-icon {
            width: 48px;
            height: 48px;
            background: var(--gradient-primary);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--font-size-2xl);
            color: white;
            box-shadow: var(--shadow-glow);
            animation: pulse 2s infinite;
        }
        
        .brand-info h1 {
            font-size: var(--font-size-xl);
            font-weight: var(--font-weight-black);
            margin-bottom: var(--space-0-5);
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .brand-info p {
            font-size: var(--font-size-xs);
            color: var(--gray-500);
            margin-bottom: 0;
        }
        
        /* ========== دکمه بازگشت ========== */
        .back-to-home {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            padding: var(--space-2) var(--space-4);
            background: var(--gray-100);
            border-radius: var(--radius-lg);
            text-decoration: none;
            color: var(--gray-700);
            font-weight: var(--font-weight-medium);
            transition: all var(--transition-bounce);
            border: 2px solid transparent;
        }
        
        .back-to-home:hover {
            background: var(--gradient-primary);
            color: white;
            transform: translateX(-5px);
            box-shadow: var(--shadow-lg);
        }
        
        /* ========== کنترل‌های بالایی ========== */
        .game-controls-top {
            display: flex;
            gap: var(--space-2);
        }
        
        .sound-toggle,
        .theme-toggle-game {
            width: 44px;
            height: 44px;
            border-radius: var(--radius-full);
            background: var(--gray-100);
            border: none;
            color: var(--gray-700);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-bounce);
            position: relative;
            overflow: hidden;
        }
        
        .sound-toggle:hover,
        .theme-toggle-game:hover {
            background: var(--gradient-primary);
            color: white;
            transform: rotate(180deg) scale(1.1);
        }
        
        .sound-toggle.active {
            background: var(--gradient-success);
            color: white;
        }
        
        /* ========== بخش اصلی بازی ========== */
        .game-main {
            padding: var(--space-8) 0;
            min-height: calc(100vh - 80px);
        }
        
        /* ========== گرید اصلی ========== */
        .game-grid {
            display: grid;
            grid-template-columns: 320px 1fr 320px;
            gap: var(--space-6);
            height: 100%;
        }
        
        @media (max-width: 1280px) {
            .game-grid {
                grid-template-columns: 280px 1fr 280px;
            }
        }
        
        @media (max-width: 1024px) {
            .game-grid {
                grid-template-columns: 1fr;
            }
            
            .player-panel,
            .settings-panel {
                display: none;
            }
            
            .mobile-controls {
                display: block;
            }
        }
        
        /* ========== پنل بازیکنان ========== */
        .player-panel {
            display: flex;
            flex-direction: column;
            gap: var(--space-6);
        }
        
        /* ========== کارت بازیکن ========== */
        .player-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: var(--radius-2xl);
            padding: var(--space-6);
            box-shadow: var(--shadow-xl);
            transition: all var(--transition-bounce);
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }
        
        [data-theme="dark"] .player-card {
            background: rgba(30, 41, 59, 0.9);
        }
        
        .player-card.active-player {
            border-color: var(--primary-color);
            box-shadow: var(--shadow-glow);
            transform: translateY(-4px) scale(1.02);
        }
        
        .player-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 4px;
            background: var(--gradient-primary);
            transform: scaleX(0);
            transition: transform var(--transition-normal);
        }
        
        .player-card.active-player::before {
            transform: scaleX(1);
        }
        
        .player-x-card .player-icon {
            background: var(--gradient-x);
            color: white;
        }
        
        .player-o-card .player-icon {
            background: var(--gradient-o);
            color: white;
        }
        
        .player-header {
            display: flex;
            align-items: center;
            gap: var(--space-4);
            margin-bottom: var(--space-6);
        }
        
        .player-icon {
            width: 80px;
            height: 80px;
            border-radius: var(--radius-2xl);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--font-size-3xl);
            flex-shrink: 0;
            box-shadow: var(--shadow-lg);
            animation: float 6s ease-in-out infinite;
        }
        
        .player-info {
            flex-grow: 1;
        }
        
        .player-name {
            font-size: var(--font-size-xl);
            font-weight: var(--font-weight-black);
            color: var(--gray-800);
            margin-bottom: var(--space-2);
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }
        
        .player-level {
            font-size: var(--font-size-xs);
            background: var(--gradient-gold);
            color: white;
            padding: var(--space-0-5) var(--space-2);
            border-radius: var(--radius-full);
        }
        
        .player-type {
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }
        
        .player-type-badge {
            padding: var(--space-1) var(--space-3);
            border-radius: var(--radius-full);
            font-size: var(--font-size-2xs);
            font-weight: var(--font-weight-bold);
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .player-type-badge.human {
            background: var(--gradient-success);
            color: white;
        }
        
        .player-type-badge.ai {
            background: var(--gradient-secondary);
            color: white;
        }
        
        .change-type-btn {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-full);
            background: var(--gray-200);
            border: none;
            color: var(--gray-600);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-bounce);
        }
        
        .change-type-btn:hover {
            background: var(--gradient-primary);
            color: white;
            transform: rotate(180deg);
        }
        
        /* ========== آمار بازیکن ========== */
        .player-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--space-3);
            margin-bottom: var(--space-6);
            padding: var(--space-4);
            background: var(--gray-100);
            border-radius: var(--radius-xl);
        }
        
        [data-theme="dark"] .player-stats {
            background: var(--gray-700);
        }
        
        .stat-item {
            text-align: center;
            padding: var(--space-2);
            border-radius: var(--radius-lg);
            transition: all var(--transition-fast);
        }
        
        .stat-item:hover {
            background: rgba(59, 130, 246, 0.1);
            transform: scale(1.05);
        }
        
        .stat-label {
            font-size: var(--font-size-2xs);
            color: var(--gray-500);
            margin-bottom: var(--space-1);
            font-weight: var(--font-weight-medium);
        }
        
        .stat-value {
            font-size: var(--font-size-2xl);
            font-weight: var(--font-weight-black);
            color: var(--gray-800);
            line-height: 1;
            transition: all var(--transition-fast);
        }
        
        [data-theme="dark"] .stat-value {
            color: var(--gray-100);
        }
        
        .stat-unit {
            font-size: var(--font-size-xs);
            color: var(--gray-500);
            margin-right: var(--space-0-5);
        }
        
        /* ========== نشانگر نوبت ========== */
        .player-status {
            padding-top: var(--space-4);
            border-top: 1px solid var(--gray-200);
        }
        
        [data-theme="dark"] .player-status {
            border-top-color: var(--gray-600);
        }
        
        .turn-indicator {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            padding: var(--space-3) var(--space-4);
            background: var(--gray-100);
            border-radius: var(--radius-xl);
            color: var(--gray-700);
            font-weight: var(--font-weight-bold);
            transition: all var(--transition-normal);
        }
        
        [data-theme="dark"] .turn-indicator {
            background: var(--gray-700);
            color: var(--gray-300);
        }
        
        .turn-indicator.current-turn {
            background: var(--gradient-primary);
            color: white;
            box-shadow: var(--shadow-glow);
            animation: moveIndicator 2s ease-in-out infinite;
        }
        
        .turn-indicator i {
            font-size: var(--font-size-lg);
            animation: pulse 2s infinite;
        }
        
        .thinking-indicator {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            padding: var(--space-3) var(--space-4);
            background: var(--gradient-secondary);
            border-radius: var(--radius-xl);
            color: white;
            font-weight: var(--font-weight-bold);
            margin-top: var(--space-3);
            animation: thinkingPulse 1.5s ease-in-out infinite;
        }
        
        .thinking-indicator i {
            animation: spin 2s linear infinite;
        }
        
        /* ========== کارت آمار کلی ========== */
        .stats-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: var(--radius-2xl);
            padding: var(--space-6);
            box-shadow: var(--shadow-xl);
        }
        
        [data-theme="dark"] .stats-card {
            background: rgba(30, 41, 59, 0.9);
        }
        
        .stats-card h4 {
            font-size: var(--font-size-lg);
            color: var(--gray-800);
            margin-bottom: var(--space-4);
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }
        
        [data-theme="dark"] .stats-card h4 {
            color: var(--gray-100);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-4);
            margin-bottom: var(--space-4);
        }
        
        .stats-item {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            padding: var(--space-3);
            background: var(--gray-100);
            border-radius: var(--radius-lg);
            transition: all var(--transition-fast);
        }
        
        [data-theme="dark"] .stats-item {
            background: var(--gray-700);
        }
        
        .stats-item:hover {
            background: var(--gradient-primary);
            color: white;
            transform: translateY(-2px);
        }
        
        .stats-item i {
            font-size: var(--font-size-xl);
            color: var(--primary-color);
        }
        
        .stats-item:hover i {
            color: white;
        }
        
        .stats-info {
            display: flex;
            flex-direction: column;
        }
        
        .stats-number {
            font-size: var(--font-size-xl);
            font-weight: var(--font-weight-black);
            color: var(--gray-800);
            line-height: 1;
        }
        
        [data-theme="dark"] .stats-number {
            color: var(--gray-100);
        }
        
        .stats-label {
            font-size: var(--font-size-2xs);
            color: var(--gray-500);
        }
        
        .streak-section {
            padding-top: var(--space-4);
            border-top: 1px solid var(--gray-200);
        }
        
        [data-theme="dark"] .streak-section {
            border-top-color: var(--gray-600);
        }
        
        .streak-badge {
            display: inline-flex;
            align-items: center;
            gap: var(--space-2);
            padding: var(--space-2) var(--space-4);
            background: var(--gradient-gold);
            color: white;
            border-radius: var(--radius-full);
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-bold);
            margin-top: var(--space-2);
            animation: pulse 2s infinite;
        }
        
        /* ========== تخته بازی ========== */
        .game-board-wrapper {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: var(--radius-3xl);
            padding: var(--space-8);
            box-shadow: var(--shadow-2xl);
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        [data-theme="dark"] .game-board-wrapper {
            background: rgba(30, 41, 59, 0.9);
            border-color: rgba(255, 255, 255, 0.05);
        }
        
        .board-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-6);
            flex-wrap: wrap;
            gap: var(--space-4);
        }
        
        /* ========== انتخابگر حالت بازی ========== */
        .mode-selector {
            display: flex;
            gap: var(--space-2);
            flex-wrap: wrap;
        }
        
        .mode-btn {
            padding: var(--space-3) var(--space-5);
            background: var(--gray-100);
            border: 2px solid transparent;
            border-radius: var(--radius-xl);
            color: var(--gray-700);
            font-weight: var(--font-weight-semibold);
            cursor: pointer;
            transition: all var(--transition-bounce);
            display: flex;
            align-items: center;
            gap: var(--space-2);
            position: relative;
            overflow: hidden;
        }
        
        [data-theme="dark"] .mode-btn {
            background: var(--gray-700);
            color: var(--gray-300);
        }
        
        .mode-btn:hover {
            background: var(--gradient-primary);
            color: white;
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .mode-btn.active {
            background: var(--gradient-primary);
            color: white;
            box-shadow: var(--shadow-glow);
            border-color: white;
        }
        
        .mode-btn i {
            font-size: var(--font-size-base);
        }
        
        /* ========== تایمر ========== */
        .game-timer {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            padding: var(--space-3) var(--space-6);
            background: var(--gradient-dark);
            border-radius: var(--radius-full);
            color: white;
            font-size: var(--font-size-xl);
            font-weight: var(--font-weight-black);
            box-shadow: var(--shadow-glow);
            position: relative;
            overflow: hidden;
        }
        
        .game-timer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            animation: shimmer 3s infinite;
        }
        
        .game-timer i {
            animation: pulse 1s infinite;
            position: relative;
            z-index: 1;
        }
        
        .game-timer span {
            position: relative;
            z-index: 1;
        }
        
        .timer-pulse {
            animation: timerPulse 0.5s ease-in-out infinite;
        }
        
        /* ========== تخته بازی اصلی ========== */
        .game-board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: var(--space-4);
            aspect-ratio: 1;
            max-width: 600px;
            margin: 0 auto;
            position: relative;
            padding: var(--space-6);
            background: linear-gradient(145deg, var(--gray-200), var(--gray-300));
            border-radius: var(--radius-3xl);
            box-shadow: 
                inset 0 0 30px rgba(0, 0, 0, 0.1),
                var(--shadow-2xl);
            border: 4px solid var(--gray-400);
        }
        
        [data-theme="dark"] .game-board {
            background: linear-gradient(145deg, var(--gray-800), var(--gray-900));
            border-color: var(--gray-600);
        }
        
        .cell {
            background: rgba(255, 255, 255, 0.95);
            border-radius: var(--radius-2xl);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--font-size-6xl);
            font-weight: var(--font-weight-black);
            cursor: pointer;
            transition: all var(--transition-bounce);
            position: relative;
            overflow: hidden;
            user-select: none;
            box-shadow: var(--shadow-lg);
            border: 3px solid transparent;
            color: var(--gray-800);
            transform: translateZ(0);
        }
        
        [data-theme="dark"] .cell {
            background: var(--gray-700);
            color: white;
        }
        
        .cell:hover {
            transform: scale(1.05) translateZ(20px);
            box-shadow: var(--shadow-2xl), var(--shadow-glow);
            border-color: var(--primary-color);
            background: white;
            z-index: 1;
        }
        
        .cell.x {
            color: var(--x-color);
            text-shadow: 0 0 30px rgba(239, 68, 68, 0.5);
        }
        
        .cell.o {
            color: var(--o-color);
            text-shadow: 0 0 30px rgba(59, 130, 246, 0.5);
        }
        
        .cell.win-cell {
            animation: winPulse 0.8s ease-in-out infinite;
            background: radial-gradient(circle, rgba(59, 130, 246, 0.2), rgba(139, 92, 246, 0.2));
            border-color: var(--primary-color);
        }
        
        .cell.occupied:hover {
            transform: none;
            cursor: not-allowed;
            border-color: transparent;
            box-shadow: var(--shadow-lg);
        }
        
        .cell::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.8), transparent);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.3s, height 0.3s;
            pointer-events: none;
        }
        
        .cell:active::before {
            width: 200px;
            height: 200px;
            opacity: 0;
        }
        
        /* ========== خط برنده ========== */
        .win-line {
            position: absolute;
            background: linear-gradient(90deg, 
                var(--x-color), 
                var(--o-color), 
                var(--primary-color), 
                var(--secondary-color));
            border-radius: var(--radius-full);
            z-index: var(--z-20);
            animation: drawLine 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
            box-shadow: 0 0 30px rgba(59, 130, 246, 0.6);
            pointer-events: none;
        }
        
        .horizontal-line {
            height: 12px;
            width: 0;
            left: var(--space-6);
            transform: translateY(-50%);
        }
        
        .vertical-line {
            width: 12px;
            height: 0;
            top: var(--space-6);
            transform: translateX(-50%);
        }
        
        .diagonal-line {
            height: 12px;
            width: 0;
            left: var(--space-6);
            top: 50%;
            transform: rotate(45deg) translateY(-50%);
            transform-origin: left center;
        }
        
        .diagonal-line-2 {
            height: 12px;
            width: 0;
            left: var(--space-6);
            top: 50%;
            transform: rotate(-45deg) translateY(-50%);
            transform-origin: left center;
        }
        
        /* ========== فوتر تخته ========== */
        .board-footer {
            display: grid;
            grid-template-columns: 1fr 280px;
            gap: var(--space-6);
            margin-top: var(--space-6);
        }
        
        @media (max-width: 768px) {
            .board-footer {
                grid-template-columns: 1fr;
            }
        }
        
        /* ========== تاریخچه حرکات ========== */
        .move-history {
            background: var(--gray-100);
            border-radius: var(--radius-2xl);
            padding: var(--space-6);
            max-height: 300px;
            overflow-y: auto;
        }
        
        [data-theme="dark"] .move-history {
            background: var(--gray-700);
        }
        
        .move-history h5 {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            font-size: var(--font-size-base);
            color: var(--gray-800);
            margin-bottom: var(--space-4);
            padding-bottom: var(--space-2);
            border-bottom: 2px solid var(--gray-300);
        }
        
        [data-theme="dark"] .move-history h5 {
            color: var(--gray-100);
            border-bottom-color: var(--gray-600);
        }
        
        .moves-list {
            display: flex;
            flex-direction: column;
            gap: var(--space-2);
        }
        
        .move-item {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            padding: var(--space-3);
            background: white;
            border-radius: var(--radius-lg);
            transition: all var(--transition-fast);
            border: 1px solid transparent;
        }
        
        [data-theme="dark"] .move-item {
            background: var(--gray-600);
        }
        
        .move-item:hover {
            transform: translateX(-5px);
            box-shadow: var(--shadow-md);
            border-color: var(--primary-color);
        }
        
        .move-number {
            width: 32px;
            height: 32px;
            background: var(--gray-200);
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-bold);
            color: var(--gray-700);
        }
        
        .move-player {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--font-size-lg);
            font-weight: var(--font-weight-black);
        }
        
        .move-player.x-move {
            background: rgba(239, 68, 68, 0.1);
            color: var(--x-color);
        }
        
        .move-player.o-move {
            background: rgba(59, 130, 246, 0.1);
            color: var(--o-color);
        }
        
        .move-info {
            flex-grow: 1;
        }
        
        .move-position {
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-medium);
            color: var(--gray-800);
        }
        
        .move-time {
            font-size: var(--font-size-2xs);
            color: var(--gray-500);
        }
        
        .empty-moves {
            text-align: center;
            color: var(--gray-500);
            padding: var(--space-8) 0;
            font-style: italic;
        }
        
        /* ========== بخش راهنمایی ========== */
        .hint-section {
            display: flex;
            flex-direction: column;
            gap: var(--space-4);
        }
        
        .hint-btn {
            padding: var(--space-4);
            background: var(--gradient-warning);
            border: none;
            border-radius: var(--radius-2xl);
            color: white;
            font-weight: var(--font-weight-bold);
            font-size: var(--font-size-lg);
            cursor: pointer;
            transition: all var(--transition-bounce);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-3);
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
        }
        
        .hint-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transform: translateX(-100%);
            transition: transform 0.6s;
        }
        
        .hint-btn:hover::before {
            transform: translateX(100%);
        }
        
        .hint-btn:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: var(--shadow-2xl);
        }
        
        .hint-btn i {
            font-size: var(--font-size-xl);
            animation: pulse 1.5s infinite;
        }
        
        .hint-text {
            padding: var(--space-4);
            background: linear-gradient(145deg, rgba(59, 130, 246, 0.1), rgba(139, 92, 246, 0.1));
            border-radius: var(--radius-xl);
            border-right: 6px solid var(--primary-color);
            font-size: var(--font-size-base);
            line-height: 1.8;
            color: var(--gray-700);
            transition: all var(--transition-normal);
        }
        
        [data-theme="dark"] .hint-text {
            color: var(--gray-300);
        }
        
        .hint-flash {
            animation: hintFlash 0.5s ease-in-out 3;
            background: var(--gradient-warning) !important;
            color: white !important;
        }
        
        /* ========== کنترل‌های بازی ========== */
        .game-actions {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: var(--space-4);
            margin-top: var(--space-6);
        }
        
        @media (max-width: 640px) {
            .game-actions {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        .action-btn {
            padding: var(--space-4) var(--space-6);
            border: none;
            border-radius: var(--radius-xl);
            font-weight: var(--font-weight-bold);
            cursor: pointer;
            transition: all var(--transition-bounce);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-2);
            font-size: var(--font-size-base);
            position: relative;
            overflow: hidden;
        }
        
        .action-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transform: translateX(-100%);
            transition: transform 0.6s;
        }
        
        .action-btn:hover::before {
            transform: translateX(100%);
        }
        
        .btn-new-game {
            background: var(--gradient-primary);
            color: white;
            box-shadow: var(--shadow-glow);
        }
        
        .btn-undo {
            background: var(--gradient-info);
            color: white;
        }
        
        .btn-redo {
            background: var(--gradient-secondary);
            color: white;
        }
        
        .btn-reset {
            background: var(--gradient-danger);
            color: white;
        }
        
        .action-btn:hover:not(:disabled) {
            transform: translateY(-5px) scale(1.05);
            box-shadow: var(--shadow-2xl);
        }
        
        .action-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        /* ========== وضعیت بازی ========== */
        .game-status {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-5) var(--space-8);
            margin-top: var(--space-6);
            background: var(--gradient-primary);
            border-radius: var(--radius-2xl);
            color: white;
            box-shadow: var(--shadow-xl);
            position: relative;
            overflow: hidden;
        }
        
        .game-status::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            animation: shimmer 3s infinite;
        }
        
        .status-message {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            font-size: var(--font-size-lg);
            font-weight: var(--font-weight-bold);
            position: relative;
            z-index: 1;
        }
        
        .status-message i {
            animation: pulse 2s infinite;
            font-size: var(--font-size-xl);
        }
        
        .status-actions {
            display: flex;
            gap: var(--space-3);
            position: relative;
            z-index: 1;
        }
        
        .btn-quick-restart {
            padding: var(--space-2) var(--space-6);
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: var(--radius-full);
            color: white;
            font-weight: var(--font-weight-bold);
            cursor: pointer;
            transition: all var(--transition-bounce);
            display: flex;
            align-items: center;
            gap: var(--space-2);
            backdrop-filter: blur(10px);
        }
        
        .btn-quick-restart:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
            border-color: white;
        }
        
        /* ========== پنل تنظیمات ========== */
        .settings-panel {
            display: flex;
            flex-direction: column;
            gap: var(--space-6);
        }
        
        .settings-card,
        .help-card,
        .records-card,
        .achievements-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: var(--radius-2xl);
            padding: var(--space-6);
            box-shadow: var(--shadow-xl);
        }
        
        [data-theme="dark"] .settings-card,
        [data-theme="dark"] .help-card,
        [data-theme="dark"] .records-card,
        [data-theme="dark"] .achievements-card {
            background: rgba(30, 41, 59, 0.9);
        }
        
        .settings-card h4,
        .help-card h4,
        .records-card h4,
        .achievements-card h4 {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            font-size: var(--font-size-lg);
            color: var(--gray-800);
            margin-bottom: var(--space-6);
            padding-bottom: var(--space-3);
            border-bottom: 2px solid var(--gray-200);
        }
        
        [data-theme="dark"] .settings-card h4,
        [data-theme="dark"] .help-card h4,
        [data-theme="dark"] .records-card h4,
        [data-theme="dark"] .achievements-card h4 {
            color: var(--gray-100);
            border-bottom-color: var(--gray-600);
        }
        
        .setting-group {
            margin-bottom: var(--space-5);
        }
        
        .setting-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: var(--gray-700);
            font-weight: var(--font-weight-medium);
            margin-bottom: var(--space-2);
        }
        
        [data-theme="dark"] .setting-label {
            color: var(--gray-300);
        }
        
        .setting-select {
            padding: var(--space-2) var(--space-4);
            border-radius: var(--radius-lg);
            border: 2px solid var(--gray-300);
            background: white;
            color: var(--gray-800);
            font-family: var(--font-primary);
            font-size: var(--font-size-sm);
            transition: all var(--transition-fast);
            width: 160px;
        }
        
        [data-theme="dark"] .setting-select {
            background: var(--gray-700);
            border-color: var(--gray-600);
            color: var(--gray-100);
        }
        
        .setting-select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
        }
        
        .setting-range {
            display: flex;
            align-items: center;
            gap: var(--space-3);
        }
        
        .range-slider {
            flex-grow: 1;
            height: 6px;
            -webkit-appearance: none;
            background: var(--gray-300);
            border-radius: var(--radius-full);
            outline: none;
        }
        
        [data-theme="dark"] .range-slider {
            background: var(--gray-600);
        }
        
        .range-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary-color);
            cursor: pointer;
            box-shadow: var(--shadow-glow);
            transition: all var(--transition-fast);
            border: 2px solid white;
        }
        
        .range-slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            background: var(--secondary-color);
        }
        
        .range-value {
            min-width: 50px;
            padding: var(--space-1) var(--space-2);
            background: var(--gray-100);
            border-radius: var(--radius-md);
            text-align: center;
            font-weight: var(--font-weight-bold);
            color: var(--gray-800);
        }
        
        [data-theme="dark"] .range-value {
            background: var(--gray-600);
            color: var(--gray-100);
        }
        
        .setting-checkbox {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            cursor: pointer;
        }
        
        .setting-checkbox input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: var(--primary-color);
            border-radius: var(--radius-md);
        }
        
        /* ========== راهنمای بازی ========== */
        .help-items {
            display: flex;
            flex-direction: column;
            gap: var(--space-4);
        }
        
        .help-item {
            display: flex;
            gap: var(--space-4);
            padding: var(--space-3);
            background: var(--gray-100);
            border-radius: var(--radius-xl);
            transition: all var(--transition-fast);
        }
        
        [data-theme="dark"] .help-item {
            background: var(--gray-700);
        }
        
        .help-item:hover {
            transform: translateX(-5px);
            box-shadow: var(--shadow-md);
        }
        
        .help-icon {
            width: 48px;
            height: 48px;
            background: var(--gradient-primary);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--font-size-xl);
            color: white;
            flex-shrink: 0;
        }
        
        .help-content {
            flex-grow: 1;
        }
        
        .help-content strong {
            display: block;
            color: var(--gray-800);
            margin-bottom: var(--space-1);
        }
        
        [data-theme="dark"] .help-content strong {
            color: var(--gray-100);
        }
        
        .help-content p {
            color: var(--gray-600);
            font-size: var(--font-size-sm);
            margin-bottom: 0;
            line-height: 1.8;
        }
        
        [data-theme="dark"] .help-content p {
            color: var(--gray-400);
        }
        
        /* ========== رکوردها ========== */
        .records-list {
            display: flex;
            flex-direction: column;
            gap: var(--space-3);
            margin-bottom: var(--space-6);
        }
        
        .record-item {
            display: flex;
            align-items: center;
            gap: var(--space-4);
            padding: var(--space-3);
            background: var(--gray-100);
            border-radius: var(--radius-xl);
            transition: all var(--transition-fast);
        }
        
        [data-theme="dark"] .record-item {
            background: var(--gray-700);
        }
        
        .record-item:hover {
            transform: translateX(-5px);
            box-shadow: var(--shadow-md);
        }
        
        .record-rank {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--font-size-xl);
        }
        
        .rank-1 {
            color: #FFD700;
            text-shadow: 0 0 10px #FFD700;
        }
        
        .rank-2 {
            color: #C0C0C0;
            text-shadow: 0 0 10px #C0C0C0;
        }
        
        .rank-3 {
            color: #CD7F32;
            text-shadow: 0 0 10px #CD7F32;
        }
        
        .record-info {
            flex-grow: 1;
        }
        
        .record-name {
            font-weight: var(--font-weight-bold);
            color: var(--gray-800);
        }
        
        [data-theme="dark"] .record-name {
            color: var(--gray-100);
        }
        
        .record-score {
            font-size: var(--font-size-sm);
            color: var(--gray-600);
        }
        
        [data-theme="dark"] .record-score {
            color: var(--gray-400);
        }
        
        .btn-view-all {
            width: 100%;
            padding: var(--space-3);
            background: var(--gray-100);
            border: none;
            border-radius: var(--radius-xl);
            color: var(--gray-700);
            font-weight: var(--font-weight-bold);
            cursor: pointer;
            transition: all var(--transition-fast);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-2);
        }
        
        [data-theme="dark"] .btn-view-all {
            background: var(--gray-700);
            color: var(--gray-300);
        }
        
        .btn-view-all:hover {
            background: var(--gradient-primary);
            color: white;
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        /* ========== دستاوردها ========== */
        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-3);
        }
        
        .achievement-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            padding: var(--space-4);
            background: var(--gray-100);
            border-radius: var(--radius-xl);
            transition: all var(--transition-fast);
            position: relative;
            overflow: hidden;
        }
        
        [data-theme="dark"] .achievement-item {
            background: var(--gray-700);
        }
        
        .achievement-item:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }
        
        .achievement-item.locked {
            opacity: 0.5;
            filter: grayscale(1);
        }
        
        .achievement-icon {
            width: 48px;
            height: 48px;
            background: var(--gradient-gold);
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--font-size-xl);
            color: white;
            margin-bottom: var(--space-2);
        }
        
        .achievement-title {
            font-size: var(--font-size-xs);
            font-weight: var(--font-weight-bold);
            color: var(--gray-800);
            margin-bottom: var(--space-1);
        }
        
        [data-theme="dark"] .achievement-title {
            color: var(--gray-100);
        }
        
        .achievement-progress {
            font-size: var(--font-size-2xs);
            color: var(--gray-600);
        }
        
        /* ========== مودال‌ها ========== */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
            z-index: var(--z-modal);
            align-items: center;
            justify-content: center;
            padding: var(--space-4);
            animation: fadeIn 0.3s ease-out;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: white;
            border-radius: var(--radius-3xl);
            max-width: 600px;
            width: 100%;
            box-shadow: var(--shadow-2xl);
            animation: slideUp 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        [data-theme="dark"] .modal-content {
            background: var(--gray-800);
        }
        
        .modal-header {
            padding: var(--space-6) var(--space-8);
            background: var(--gradient-primary);
            color: white;
            position: relative;
            text-align: center;
        }
        
        .modal-header h2 {
            font-size: var(--font-size-2xl);
            font-weight: var(--font-weight-black);
            margin-bottom: var(--space-2);
        }
        
        .modal-close {
            position: absolute;
            left: var(--space-6);
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: var(--radius-full);
            cursor: pointer;
            font-size: var(--font-size-2xl);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-bounce);
            backdrop-filter: blur(10px);
        }
        
        .modal-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-50%) rotate(90deg);
        }
        
        .modal-body {
            padding: var(--space-8);
        }
        
        .winner-celebration,
        .draw-celebration {
            text-align: center;
            margin-bottom: var(--space-8);
        }
        
        .winner-icon,
        .draw-icon {
            width: 120px;
            height: 120px;
            margin: 0 auto var(--space-6);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--font-size-5xl);
            color: white;
            animation: bounce 1s infinite alternate;
            box-shadow: var(--shadow-2xl);
        }
        
        .winner-icon {
            background: var(--gradient-gold);
        }
        
        .draw-icon {
            background: var(--gradient-info);
        }
        
        .winner-message h3,
        .draw-message h3 {
            font-size: var(--font-size-3xl);
            color: var(--gray-800);
            margin-bottom: var(--space-2);
            font-weight: var(--font-weight-black);
        }
        
        [data-theme="dark"] .winner-message h3,
        [data-theme="dark"] .draw-message h3 {
            color: var(--gray-100);
        }
        
        .winner-message p,
        .draw-message p {
            color: var(--gray-600);
            font-size: var(--font-size-lg);
        }
        
        [data-theme="dark"] .winner-message p,
        [data-theme="dark"] .draw-message p {
            color: var(--gray-400);
        }
        
        .winner-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--space-4);
            margin-bottom: var(--space-6);
        }
        
        .winner-stat {
            text-align: center;
            padding: var(--space-4);
            background: var(--gray-100);
            border-radius: var(--radius-xl);
        }
        
        [data-theme="dark"] .winner-stat {
            background: var(--gray-700);
        }
        
        .winner-stat i {
            font-size: var(--font-size-2xl);
            color: var(--primary-color);
            margin-bottom: var(--space-2);
        }
        
        .modal-footer {
            padding: var(--space-6) var(--space-8);
            background: var(--gray-100);
            display: flex;
            gap: var(--space-4);
            justify-content: center;
        }
        
        [data-theme="dark"] .modal-footer {
            background: var(--gray-700);
        }
        
        /* ========== دکمه‌های عمومی ========== */
        .btn {
            padding: var(--space-3) var(--space-6);
            border-radius: var(--radius-xl);
            font-weight: var(--font-weight-bold);
            cursor: pointer;
            transition: all var(--transition-bounce);
            border: none;
            font-size: var(--font-size-base);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-2);
            min-width: 140px;
            position: relative;
            overflow: hidden;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transform: translateX(-100%);
            transition: transform 0.6s;
        }
        
        .btn:hover::before {
            transform: translateX(100%);
        }
        
        .btn-primary {
            background: var(--gradient-primary);
            color: white;
            box-shadow: var(--shadow-glow);
        }
        
        .btn-secondary {
            background: var(--gray-200);
            color: var(--gray-800);
        }
        
        [data-theme="dark"] .btn-secondary {
            background: var(--gray-600);
            color: var(--gray-100);
        }
        
        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
        }
        
        .btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: var(--shadow-2xl);
        }
        
        /* ========== کنفتی ========== */
        .confetti {
            position: fixed;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            pointer-events: none;
            z-index: var(--z-modal);
            animation: confettiFall 3s ease-out forwards;
        }
        
        /* ========== کنترل‌های موبایل ========== */
        .mobile-controls {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            padding: var(--space-4);
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
            z-index: var(--z-fixed);
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        [data-theme="dark"] .mobile-controls {
            background: rgba(15, 23, 42, 0.95);
            border-top-color: rgba(255, 255, 255, 0.1);
        }
        
        .mobile-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: var(--space-2);
        }
        
        .mobile-btn {
            padding: var(--space-3);
            border: none;
            border-radius: var(--radius-xl);
            background: var(--gray-100);
            color: var(--gray-700);
            font-size: var(--font-size-sm);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-1);
            cursor: pointer;
            transition: all var(--transition-fast);
        }
        
        [data-theme="dark"] .mobile-btn {
            background: var(--gray-700);
            color: var(--gray-300);
        }
        
        .mobile-btn i {
            font-size: var(--font-size-xl);
        }
        
        .mobile-btn.active {
            background: var(--gradient-primary);
            color: white;
        }
        
        /* ========== انیمیشن‌های کلیدی ========== */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }
        
        @keyframes bounce {
            from { transform: translateY(0); }
            to { transform: translateY(-20px); }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        @keyframes rotate3D {
            0% { transform: rotateX(0) rotateY(0); }
            100% { transform: rotateX(360deg) rotateY(360deg); }
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        @keyframes winPulse {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
            }
            50% {
                transform: scale(1.1);
                box-shadow: 0 0 40px rgba(59, 130, 246, 0.8);
            }
        }
        
        @keyframes drawLine {
            0% {
                width: 0;
                opacity: 0;
            }
            100% {
                width: 100%;
                opacity: 1;
            }
        }
        
        @keyframes moveIndicator {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        
        @keyframes thinkingPulse {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; }
        }
        
        @keyframes timerPulse {
            0%, 100% { background: var(--gradient-danger); }
            50% { background: var(--gradient-warning); }
        }
        
        @keyframes confettiFall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
        
        @keyframes hintFlash {
            0%, 100% { background: var(--gradient-warning); }
            50% { background: var(--gradient-gold); }
        }
        
        @keyframes scoreUpdate {
            0% { transform: scale(1); color: var(--gray-800); }
            50% { transform: scale(1.5); color: var(--success-color); }
            100% { transform: scale(1); color: var(--gray-800); }
        }
        
        /* ========== کلاس‌های کمکی ========== */
        .d-none { display: none !important; }
        .d-block { display: block !important; }
        .d-flex { display: flex !important; }
        .d-grid { display: grid !important; }
        
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .text-left { text-align: left; }
        
        .w-100 { width: 100%; }
        .h-100 { height: 100%; }
        
        .position-relative { position: relative; }
        .position-absolute { position: absolute; }
        .position-fixed { position: fixed; }
        
        .overflow-hidden { overflow: hidden; }
        .overflow-auto { overflow: auto; }
        
        .cursor-pointer { cursor: pointer; }
        .cursor-not-allowed { cursor: not-allowed; }
        
        .user-select-none { user-select: none; }
        
        .shadow-glow { box-shadow: var(--shadow-glow); }
        .rounded-full { border-radius: var(--radius-full); }
        
        /* ========== ریسپانسیو ========== */
        @media (max-width: 1024px) {
            .game-grid {
                grid-template-columns: 1fr;
            }
            
            .player-panel,
            .settings-panel {
                display: none;
            }
            
            .mobile-controls {
                display: block;
            }
        }
        
        @media (max-width: 768px) {
            .game-board {
                max-width: 100%;
                padding: var(--space-4);
            }
            
            .cell {
                font-size: var(--font-size-4xl);
            }
            
            .board-header {
                flex-direction: column;
            }
            
            .mode-selector {
                width: 100%;
                justify-content: center;
            }
            
            .game-status {
                flex-direction: column;
                gap: var(--space-4);
                text-align: center;
            }
            
            .status-actions {
                width: 100%;
            }
            
            .btn-quick-restart {
                width: 100%;
            }
            
            .game-actions {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .modal-content {
                max-width: 95%;
            }
            
            .winner-stats {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 480px) {
            .game-board-wrapper {
                padding: var(--space-4);
            }
            
            .cell {
                font-size: var(--font-size-3xl);
            }
            
            .game-timer {
                width: 100%;
                justify-content: center;
            }
            
            .game-actions {
                grid-template-columns: 1fr;
            }
            
            .mobile-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .modal-footer {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }
        
        @media print {
            .game-header,
            .game-controls-top,
            .game-actions,
            .mobile-controls,
            .modal {
                display: none !important;
            }
            
            .game-board {
                box-shadow: none;
                border: 2px solid #000;
            }
        }
    </style>
</head>
<body>
    <!-- ========== صفحه بارگذاری فوق حرفه‌ای ========== -->
    <div id="game-loading" class="game-loading">
        <div class="game-loader">
            <div class="loader-3d">
                <div class="loader-cube">
                    <div class="loader-face face-front">X</div>
                    <div class="loader-face face-back">O</div>
                    <div class="loader-face face-right">X</div>
                    <div class="loader-face face-left">O</div>
                    <div class="loader-face face-top">X</div>
                    <div class="loader-face face-bottom">O</div>
                </div>
            </div>
            
            <div class="loader-progress">
                <div class="progress-text" id="loadingText">🚀 در حال بارگذاری موتور بازی...</div>
                <div class="progress-bar-container">
                    <div class="progress-bar-fill" id="loadingProgress" style="width: 0%;"></div>
                </div>
                <div class="loading-tips" id="loadingTip">
                    💡 آیا می‌دانستید؟ بازی دوز یکی از قدیمی‌ترین بازی‌های جهان است که قدمت آن به ۱۳۰۰ سال قبل از میلاد می‌رسد!
                </div>
            </div>
        </div>
    </div>
    
    <!-- ========== هدر بازی ========== -->
    <header class="game-header">
        <div class="container">
            <div class="game-navbar">
                <div class="game-brand">
                    <div class="brand-icon">
                        <i class="fas fa-times"></i>
                        <i class="fas fa-circle"></i>
                    </div>
                    <div class="brand-info">
                        <h1>دوز حرفه‌ای ۲۰۲۴</h1>
                        <p>با هوش مصنوعی قدرتمند</p>
                    </div>
                </div>
                
                <div class="game-controls-top">
                    <button class="sound-toggle active" id="soundToggle" aria-label="کنترل صدا">
                        <i class="fas fa-volume-up"></i>
                    </button>
                    <button class="theme-toggle-game" id="themeToggle" aria-label="تغییر تم">
                        <i class="fas fa-moon"></i>
                    </button>
                </div>
            </div>
        </div>
    </header>
    
    <!-- ========== بخش اصلی بازی ========== -->
    <main class="game-main">
        <div class="container">
            <div class="game-grid">
                <!-- ========== پنل بازیکنان ========== -->
                <div class="player-panel">
                    <!-- بازیکن X -->
                    <div class="player-card player-x-card active-player" id="playerXCard">
                        <div class="player-header">
                            <div class="player-icon">
                                <i class="fas fa-times"></i>
                            </div>
                            <div class="player-info">
                                <div class="player-name">
                                    بازیکن X
                                    <span class="player-level" id="playerXLevel">پلاتینیوم</span>
                                </div>
                                <div class="player-type">
                                    <span class="player-type-badge human" id="playerXType">انسان</span>
                                    <button class="change-type-btn" data-player="x" aria-label="تغییر نوع بازیکن">
                                        <i class="fas fa-sync-alt"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="player-stats">
                            <div class="stat-item">
                                <div class="stat-label">امتیاز</div>
                                <div class="stat-value" id="playerXScore">1,280</div>
                                <span class="stat-unit">XP</span>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">برد</div>
                                <div class="stat-value" id="playerXWins">42</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">درصد</div>
                                <div class="stat-value" id="playerXWinRate">78%</div>
                            </div>
                        </div>
                        
                        <div class="player-status">
                            <div class="turn-indicator current-turn" id="xTurnIndicator">
                                <i class="fas fa-chess-queen"></i>
                                <span>نوبت شماست</span>
                            </div>
                            <div class="thinking-indicator d-none" id="xThinking">
                                <i class="fas fa-brain"></i>
                                <span>هوش مصنوعی در حال فکر کردن...</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- بازیکن O -->
                    <div class="player-card player-o-card" id="playerOCard">
                        <div class="player-header">
                            <div class="player-icon">
                                <i class="fas fa-circle"></i>
                            </div>
                            <div class="player-info">
                                <div class="player-name">
                                    بازیکن O
                                    <span class="player-level" id="playerOLevel">طلا</span>
                                </div>
                                <div class="player-type">
                                    <span class="player-type-badge human" id="playerOType">انسان</span>
                                    <button class="change-type-btn" data-player="o" aria-label="تغییر نوع بازیکن">
                                        <i class="fas fa-sync-alt"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="player-stats">
                            <div class="stat-item">
                                <div class="stat-label">امتیاز</div>
                                <div class="stat-value" id="playerOScore">890</div>
                                <span class="stat-unit">XP</span>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">برد</div>
                                <div class="stat-value" id="playerOWins">28</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">درصد</div>
                                <div class="stat-value" id="playerOWinRate">62%</div>
                            </div>
                        </div>
                        
                        <div class="player-status">
                            <div class="turn-indicator" id="oTurnIndicator">
                                <i class="fas fa-clock"></i>
                                <span>منتظر نوبت</span>
                            </div>
                            <div class="thinking-indicator d-none" id="oThinking">
                                <i class="fas fa-brain"></i>
                                <span>هوش مصنوعی در حال فکر کردن...</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- کارت آمار کلی -->
                    <div class="stats-card">
                        <h4><i class="fas fa-chart-bar"></i> آمار کلی</h4>
                        
                        <div class="stats-grid">
                            <div class="stats-item">
                                <i class="fas fa-gamepad"></i>
                                <div class="stats-info">
                                    <span class="stats-number" id="totalGames">187</span>
                                    <span class="stats-label">بازی‌ها</span>
                                </div>
                            </div>
                            <div class="stats-item">
                                <i class="fas fa-handshake"></i>
                                <div class="stats-info">
                                    <span class="stats-number" id="totalDraws">23</span>
                                    <span class="stats-label">تساوی</span>
                                </div>
                            </div>
                            <div class="stats-item">
                                <i class="fas fa-clock"></i>
                                <div class="stats-info">
                                    <span class="stats-number" id="totalTime">846</span>
                                    <span class="stats-label">دقیقه</span>
                                </div>
                            </div>
                            <div class="stats-item">
                                <i class="fas fa-trophy"></i>
                                <div class="stats-info">
                                    <span class="stats-number" id="winStreak">7</span>
                                    <span class="stats-label">رکورد</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="streak-section">
                            <div class="streak-badge">
                                <i class="fas fa-fire"></i>
                                <span>برد متوالی: <span id="currentStreak">3</span></span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ========== تخته بازی ========== -->
                <div class="game-board-wrapper">
                    <div class="board-header">
                        <div class="mode-selector">
                            <button class="mode-btn active" data-mode="pvp">
                                <i class="fas fa-user-friends"></i>
                                دو نفره
                            </button>
                            <button class="mode-btn" data-mode="easy">
                                <i class="fas fa-smile"></i>
                                آسان
                            </button>
                            <button class="mode-btn" data-mode="medium">
                                <i class="fas fa-brain"></i>
                                متوسط
                            </button>
                            <button class="mode-btn" data-mode="hard">
                                <i class="fas fa-robot"></i>
                                سخت
                            </button>
                            <button class="mode-btn" data-mode="expert">
                                <i class="fas fa-crown"></i>
                                استاد
                            </button>
                        </div>
                        
                        <div class="game-timer" id="gameTimer">
                            <i class="fas fa-hourglass-half"></i>
                            <span>00:00</span>
                        </div>
                    </div>
                    
                    <div class="game-board" id="gameBoard">
                        <!-- سلول‌های بازی با جاوااسکریپت ساخته می‌شوند -->
                    </div>
                    
                    <div class="board-footer">
                        <div class="move-history">
                            <h5><i class="fas fa-history"></i> تاریخچه حرکات</h5>
                            <div class="moves-list" id="movesList">
                                <div class="empty-moves">هنوز حرکتی انجام نشده است</div>
                            </div>
                        </div>
                        
                        <div class="hint-section">
                            <button class="hint-btn" id="hintBtn">
                                <i class="fas fa-lightbulb"></i>
                                دریافت راهنمایی
                            </button>
                            <div class="hint-text" id="hintText">
                                ⚡ برای شروع، خانه مرکزی یا گوشه‌ها بهترین انتخاب هستند
                            </div>
                        </div>
                    </div>
                    
                    <div class="game-actions">
                        <button class="action-btn btn-new-game" id="newGameBtn">
                            <i class="fas fa-plus-circle"></i>
                            بازی جدید
                        </button>
                        <button class="action-btn btn-undo" id="undoBtn" disabled>
                            <i class="fas fa-undo-alt"></i>
                            بازگشت
                        </button>
                        <button class="action-btn btn-redo" id="redoBtn" disabled>
                            <i class="fas fa-redo-alt"></i>
                            تکرار
                        </button>
                        <button class="action-btn btn-reset" id="resetStatsBtn">
                            <i class="fas fa-trash-alt"></i>
                            ریست آمار
                        </button>
                    </div>
                    
                    <div class="game-status" id="gameStatus">
                        <div class="status-message">
                            <i class="fas fa-info-circle"></i>
                            <span id="statusText">بازی را شروع کنید! نوبت بازیکن X</span>
                        </div>
                        <div class="status-actions">
                            <button class="btn-quick-restart" id="quickRestartBtn">
                                <i class="fas fa-sync-alt"></i>
                                شروع سریع
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- ========== پنل تنظیمات و اطلاعات ========== -->
                <div class="settings-panel">
                    <!-- کارت تنظیمات -->
                    <div class="settings-card">
                        <h4><i class="fas fa-cog"></i> تنظیمات بازی</h4>
                        
                        <div class="setting-group">
                            <label class="setting-label">
                                <span>📏 اندازه تخته:</span>
                                <select id="boardSize" class="setting-select">
                                    <option value="3">۳×۳ (کلاسیک)</option>
                                    <option value="4">۴×۴ (پیشرفته)</option>
                                    <option value="5">۵×۵ (حرفه‌ای)</option>
                                    <option value="6">۶×۶ (چالش)</option>
                                </select>
                            </label>
                        </div>
                        
                        <div class="setting-group">
                            <label class="setting-label">
                                <span>⏱️ زمان هر حرکت:</span>
                                <div class="setting-range">
                                    <input type="range" id="moveTime" class="range-slider" min="10" max="120" value="30" step="5">
                                    <span class="range-value" id="moveTimeValue">۳۰</span>
                                </div>
                            </label>
                        </div>
                        
                        <div class="setting-group">
                            <label class="setting-checkbox">
                                <input type="checkbox" id="soundEffects" checked>
                                <span>🔊 صداهای بازی</span>
                            </label>
                        </div>
                        
                        <div class="setting-group">
                            <label class="setting-checkbox">
                                <input type="checkbox" id="animations" checked>
                                <span>✨ انیمیشن‌ها</span>
                            </label>
                        </div>
                        
                        <div class="setting-group">
                            <label class="setting-checkbox">
                                <input type="checkbox" id="highlightMoves" checked>
                                <span>🎯 هایلایت حرکات</span>
                            </label>
                        </div>
                        
                        <div class="setting-group">
                            <label class="setting-checkbox">
                                <input type="checkbox" id="autoSuggest" checked>
                                <span>💡 پیشنهاد خودکار</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- کارت راهنما -->
                    <div class="help-card">
                        <h4><i class="fas fa-question-circle"></i> استراتژی‌های حرفه‌ای</h4>
                        
                        <div class="help-items">
                            <div class="help-item">
                                <div class="help-icon">
                                    <i class="fas fa-bullseye"></i>
                                </div>
                                <div class="help-content">
                                    <strong>۱. تصاحب مرکز</strong>
                                    <p>خانه مرکزی مهم‌ترین خانه تخته است. همیشه سعی کنید اول مرکز را تصاحب کنید.</p>
                                </div>
                            </div>
                            
                            <div class="help-item">
                                <div class="help-icon">
                                    <i class="fas fa-chess-rook"></i>
                                </div>
                                <div class="help-content">
                                    <strong>۲. گوشه‌ها را بگیرید</strong>
                                    <p>بعد از مرکز، گوشه‌ها قدرتمندترین خانه‌ها هستند. از آنها برای ایجاد تهدید دوطرفه استفاده کنید.</p>
                                </div>
                            </div>
                            
                            <div class="help-item">
                                <div class="help-icon">
                                    <i class="fas fa-shield-alt"></i>
                                </div>
                                <div class="help-content">
                                    <strong>۳. دفاع هوشمند</strong>
                                    <p>همیشه مراقب تهدیدات حریف باشید. اگر حریف دو در یک ردیف دارد، بلافاصله آن را ببندید.</p>
                                </div>
                            </div>
                            
                            <div class="help-item">
                                <div class="help-icon">
                                    <i class="fas fa-code-branch"></i>
                                </div>
                                <div class="help-content">
                                    <strong>۴. ایجاد چنگال</strong>
                                    <p>سعی کنید در یک حرکت، دو تهدید همزمان ایجاد کنید. حریف نمی‌تواند هر دو را ببندد.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- کارت رکوردهای برتر -->
                    <div class="records-card">
                        <h4><i class="fas fa-trophy"></i> ۱۰ بازیکن برتر</h4>
                        
                        <div class="records-list" id="leaderboardList">
                            <div class="record-item">
                                <span class="record-rank rank-1">🥇</span>
                                <div class="record-info">
                                    <div class="record-name">آرمان</div>
                                    <div class="record-score">۱۵۸ برد • ۲۳۰۰ امتیاز</div>
                                </div>
                            </div>
                            <div class="record-item">
                                <span class="record-rank rank-2">🥈</span>
                                <div class="record-info">
                                    <div class="record-name">ا</div>
                                    <div class="record-score">۱۴۲ برد • ۲۱۰۰ امتیاز</div>
                                </div>
                            </div>
                            <div class="record-item">
                                <span class="record-rank rank-3">🥉</span>
                                <div class="record-info">
                                    <div class="record-name">کیان</div>
                                    <div class="record-score">۱۳۸ برد • ۲۰۵۰ امتیاز</div>
                                </div>
                            </div>
                        </div>
                        
                        <button class="btn-view-all" id="viewLeaderboardBtn">
                            <i class="fas fa-list-ul"></i>
                            مشاهده همه
                        </button>
                    </div>
                    
                    <!-- کارت دستاوردها -->
                    <div class="achievements-card">
                        <h4><i class="fas fa-medal"></i> دستاوردها</h4>
                        
                        <div class="achievements-grid" id="achievementsList">
                            <div class="achievement-item">
                                <div class="achievement-icon">
                                    <i class="fas fa-trophy"></i>
                                </div>
                                <div class="achievement-title">اولین برد</div>
                                <div class="achievement-progress">✅ انجام شد</div>
                            </div>
                            <div class="achievement-item locked">
                                <div class="achievement-icon">
                                    <i class="fas fa-bolt"></i>
                                </div>
                                <div class="achievement-title">۱۰ برد متوالی</div>
                                <div class="achievement-progress">۷/۱۰</div>
                            </div>
                            <div class="achievement-item">
                                <div class="achievement-icon">
                                    <i class="fas fa-clock"></i>
                                </div>
                                <div class="achievement-title">سریع‌ترین برد</div>
                                <div class="achievement-progress">۴ حرکت</div>
                            </div>
                            <div class="achievement-item locked">
                                <div class="achievement-icon">
                                    <i class="fas fa-robot"></i>
                                </div>
                                <div class="achievement-title">شکست استاد</div>
                                <div class="achievement-progress">۰/۵</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <!-- ========== کنترل‌های موبایل ========== -->
    <div class="mobile-controls">
        <div class="mobile-grid">
            <button class="mobile-btn active" data-panel="game">
                <i class="fas fa-gamepad"></i>
                بازی
            </button>
            <button class="mobile-btn" data-panel="players">
                <i class="fas fa-users"></i>
                بازیکنان
            </button>
            <button class="mobile-btn" data-panel="stats">
                <i class="fas fa-chart-bar"></i>
                آمار
            </button>
            <button class="mobile-btn" data-panel="settings">
                <i class="fas fa-cog"></i>
                تنظیمات
            </button>
        </div>
    </div>
    
    <!-- ========== مودال برنده ========== -->
    <div class="modal" id="winnerModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="winnerModalTitle">🎉 تبریک! شما برنده شدید! 🎉</h2>
                <button class="modal-close" id="modalClose">&times;</button>
            </div>
            
            <div class="modal-body">
                <div class="winner-celebration">
                    <div class="winner-icon" id="winnerModalIcon">
                        <i class="fas fa-trophy"></i>
                    </div>
                    <div class="winner-message">
                        <h3 id="winnerModalPlayer">بازیکن X</h3>
                        <p id="winnerModalDesc">با ۵ حرکت و ۴۵ ثانیه برنده شد!</p>
                    </div>
                </div>
                
                <div class="winner-stats">
                    <div class="winner-stat">
                        <i class="fas fa-bolt"></i>
                        <div>
                            <div class="stat-value" id="winnerModalMoves">۵</div>
                            <div class="stat-label">حرکات</div>
                        </div>
                    </div>
                    <div class="winner-stat">
                        <i class="fas fa-clock"></i>
                        <div>
                            <div class="stat-value" id="winnerModalTime">۴۵</div>
                            <div class="stat-label">ثانیه</div>
                        </div>
                    </div>
                    <div class="winner-stat">
                        <i class="fas fa-star"></i>
                        <div>
                            <div class="stat-value" id="winnerModalXP">+۱۵</div>
                            <div class="stat-label">امتیاز</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="modal-footer">
                <button class="btn btn-secondary" id="rematchBtn">
                    <i class="fas fa-redo-alt"></i>
                    بازی مجدد
                </button>
                <button class="btn btn-primary" id="newGameModalBtn">
                    <i class="fas fa-plus-circle"></i>
                    بازی جدید
                </button>
                <button class="btn btn-outline" id="shareWinBtn">
                    <i class="fas fa-share-alt"></i>
                    اشتراک‌گذاری
                </button>
            </div>
        </div>
    </div>
    
    <!-- ========== مودال تساوی ========== -->
    <div class="modal" id="drawModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>🤝 بازی مساوی شد!</h2>
                <button class="modal-close">&times;</button>
            </div>
            
            <div class="modal-body">
                <div class="draw-celebration">
                    <div class="draw-icon">
                        <i class="fas fa-handshake"></i>
                    </div>
                    <div class="draw-message">
                        <h3>بازی حساسی بود!</h3>
                        <p>هر دو بازیکن عالی بازی کردند. دوباره تلاش کنید!</p>
                    </div>
                </div>
            </div>
            
            <div class="modal-footer">
                <button class="btn btn-primary" id="drawRematchBtn">
                    <i class="fas fa-redo-alt"></i>
                    بازی مجدد
                </button>
            </div>
        </div>
    </div>
    
    <!-- ========== صداهای بازی ========== -->
    <audio id="clickSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-select-click-1109.mp3" type="audio/mpeg">
    </audio>
    <audio id="winSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3" type="audio/mpeg">
    </audio>
    <audio id="drawSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-game-ball-tap-2073.mp3" type="audio/mpeg">
    </audio>
    <audio id="errorSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3" type="audio/mpeg">
    </audio>
    <audio id="hintSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-magic-sparkle-sweep-292.mp3" type="audio/mpeg">
    </audio>
    <audio id="moveSound" preload="auto">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-arcade-game-jump-coin-216.mp3" type="audio/mpeg">
    </audio>
    
    <!-- ========== اسکریپت اصلی بازی ========== -->
    <script>
        // ============================================
        // TIC TAC TOE PRO - نسخه نهایی با بیش از ۴۰۰۰ خط کد
        // طراحی و توسعه: Ali369 Studio
        // نسخه: ۳.۰.۰
        // تاریخ: بهمن ۱۴۰۲
        // ============================================
        
        'use strict';
        
        // ============================================
        // ۱. تعاریف و ثابت‌های اصلی
        // ============================================
        
        const GAME_VERSION = '3.0.0';
        const GAME_NAME = 'بازی دوز حرفه‌ای';
        const STUDIO_NAME = 'Ali369 Studio';
        const BUILD_DATE = '2024-01-25';
        
        // ترکیب‌های برنده برای تخته ۳x۳
        const WIN_PATTERNS_3x3 = [
            [0, 1, 2], [3, 4, 5], [6, 7, 8], // ردیف‌ها
            [0, 3, 6], [1, 4, 7], [2, 5, 8], // ستون‌ها
            [0, 4, 8], [2, 4, 6]             // قطرها
        ];
        
        // ترکیب‌های برنده برای تخته ۴x۴
        const WIN_PATTERNS_4x4 = [
            [0, 1, 2, 3], [4, 5, 6, 7], [8, 9, 10, 11], [12, 13, 14, 15], // ردیف‌ها
            [0, 4, 8, 12], [1, 5, 9, 13], [2, 6, 10, 14], [3, 7, 11, 15], // ستون‌ها
            [0, 5, 10, 15], [3, 6, 9, 12]                                 // قطرها
        ];
        
        // ============================================
        // ۲. کلاس هوش مصنوعی پیشرفته با الگوریتم Minimax
        // ============================================
        
        class TicTacToeAI {
            constructor(difficulty = 'medium', boardSize = 3) {
                this.difficulty = difficulty;
                this.boardSize = boardSize;
                this.scores = { X: -100, O: 100, tie: 0 };
                
                // تنظیم عمق جستجو بر اساس سطح دشواری
                this.depths = {
                    'easy': 1,
                    'medium': 3,
                    'hard': 5,
                    'expert': 7
                };
                
                // درصد حرکات تصادفی برای سطوح مختلف
                this.randomness = {
                    'easy': 0.6,
                    'medium': 0.3,
                    'hard': 0.1,
                    'expert': 0
                };
            }
            
            // ========== دریافت حرکت هوش مصنوعی ==========
            getMove(board, player) {
                // برای سطح آسان، حرکات تصادفی بیشتر
                if (Math.random() < this.randomness[this.difficulty]) {
                    return this.getRandomMove(board);
                }
                
                const depth = this.depths[this.difficulty] || 3;
                return this.minimax(board, player, depth, -Infinity, Infinity, true).position;
            }
            
            // ========== حرکت تصادفی ==========
            getRandomMove(board) {
                const availableMoves = board
                    .map((cell, index) => cell === null ? index : null)
                    .filter(index => index !== null);
                
                if (availableMoves.length === 0) return null;
                
                const randomIndex = Math.floor(Math.random() * availableMoves.length);
                return availableMoves[randomIndex];
            }
            
            // ========== الگوریتم Minimax با هرس آلفا-بتا ==========
            minimax(board, player, depth, alpha, beta, isMaximizing) {
                // بررسی پایان بازی
                const winner = this.checkWinner(board);
                
                if (winner !== null || depth === 0) {
                    if (winner === 'O') return { score: this.scores.O - depth };
                    if (winner === 'X') return { score: this.scores.X + depth };
                    if (winner === 'tie') return { score: 0 };
                    return { score: 0 };
                }
                
                if (isMaximizing) {
                    let bestScore = -Infinity;
                    let bestMove = null;
                    
                    for (let i = 0; i < board.length; i++) {
                        if (board[i] === null) {
                            board[i] = 'O';
                            const result = this.minimax(board, player, depth - 1, alpha, beta, false);
                            board[i] = null;
                            
                            if (result.score > bestScore) {
                                bestScore = result.score;
                                bestMove = i;
                            }
                            
                            alpha = Math.max(alpha, bestScore);
                            if (beta <= alpha) break;
                        }
                    }
                    
                    return { score: bestScore, position: bestMove };
                } else {
                    let bestScore = Infinity;
                    let bestMove = null;
                    
                    for (let i = 0; i < board.length; i++) {
                        if (board[i] === null) {
                            board[i] = 'X';
                            const result = this.minimax(board, player, depth - 1, alpha, beta, true);
                            board[i] = null;
                            
                            if (result.score < bestScore) {
                                bestScore = result.score;
                                bestMove = i;
                            }
                            
                            beta = Math.min(beta, bestScore);
                            if (beta <= alpha) break;
                        }
                    }
                    
                    return { score: bestScore, position: bestMove };
                }
            }
            
            // ========== بررسی برنده ==========
            checkWinner(board) {
                const patterns = this.boardSize === 3 ? WIN_PATTERNS_3x3 : WIN_PATTERNS_4x4;
                
                for (const pattern of patterns) {
                    const first = board[pattern[0]];
                    if (!first) continue;
                    
                    let win = true;
                    for (let i = 1; i < pattern.length; i++) {
                        if (board[pattern[i]] !== first) {
                            win = false;
                            break;
                        }
                    }
                    
                    if (win) return first;
                }
                
                if (!board.includes(null)) return 'tie';
                return null;
            }
            
            // ========== دریافت بهترین حرکت برای راهنمایی ==========
            getHint(board, player) {
                // برای راهنمایی، از سطح سخت استفاده می‌کنیم
                const depth = 5;
                const result = this.minimax(board, player === 'X' ? 'O' : 'X', depth, -Infinity, Infinity, player === 'O');
                return result.position;
            }
        }
        
        // ============================================
        // ۳. کلاس اصلی بازی
        // ============================================
        
        class TicTacToeGame {
            constructor() {
                // ========== وضعیت بازی ==========
                this.boardSize = 3;
                this.board = Array(9).fill(null);
                this.currentPlayer = 'X';
                this.gameActive = false;
                this.gameMode = 'pvp';
                this.aiDifficulty = 'medium';
                this.winner = null;
                this.winningPattern = null;
                
                // ========== تاریخچه ==========
                this.moveHistory = [];
                this.moveHistoryIndex = -1;
                this.moveCount = 0;
                
                // ========== تایمر ==========
                this.timer = {
                    startTime: null,
                    elapsedSeconds: 0,
                    interval: null,
                    moveStartTime: null,
                    moveTimeLimit: 30
                };
                
                // ========== بازیکنان ==========
                this.players = {
                    X: {
                        type: 'human',
                        name: 'بازیکن X',
                        score: 1280,
                        wins: 42,
                        losses: 18,
                        draws: 12,
                        games: 72,
                        streak: 3,
                        level: 'پلاتینیوم'
                    },
                    O: {
                        type: 'human',
                        name: 'بازیکن O',
                        score: 890,
                        wins: 28,
                        losses: 32,
                        draws: 12,
                        games: 72,
                        streak: 1,
                        level: 'طلا'
                    }
                };
                
                // ========== آمار کلی ==========
                this.stats = {
                    totalGames: 187,
                    totalDraws: 23,
                    totalTime: 846,
                    winStreak: 7,
                    currentStreak: 3,
                    fastestWin: 18,
                    xWins: 42,
                    oWins: 28
                };
                
                // ========== تنظیمات ==========
                this.settings = {
                    soundEnabled: true,
                    animations: true,
                    highlightMoves: true,
                    autoSuggest: true,
                    moveTimeLimit: 30,
                    boardSize: 3
                };
                
                // ========== دستاوردها ==========
                this.achievements = {
                    firstWin: { unlocked: true, progress: 1, total: 1 },
                    winStreak10: { unlocked: false, progress: 7, total: 10 },
                    fastestWin: { unlocked: true, progress: 4, total: 4 },
                    beatExpert: { unlocked: false, progress: 0, total: 5 }
                };
                
                // ========== صداها ==========
                this.sounds = {
                    click: document.getElementById('clickSound'),
                    win: document.getElementById('winSound'),
                    draw: document.getElementById('drawSound'),
                    error: document.getElementById('errorSound'),
                    hint: document.getElementById('hintSound'),
                    move: document.getElementById('moveSound')
                };
                
                // ========== DOM Elements ==========
                this.elements = {
                    loading: document.getElementById('game-loading'),
                    loadingProgress: document.getElementById('loadingProgress'),
                    loadingText: document.getElementById('loadingText'),
                    loadingTip: document.getElementById('loadingTip'),
                    
                    gameBoard: document.getElementById('gameBoard'),
                    cells: [],
                    
                    playerXCard: document.getElementById('playerXCard'),
                    playerOCard: document.getElementById('playerOCard'),
                    playerXScore: document.getElementById('playerXScore'),
                    playerOScore: document.getElementById('playerOScore'),
                    playerXWins: document.getElementById('playerXWins'),
                    playerOWins: document.getElementById('playerOWins'),
                    playerXWinRate: document.getElementById('playerXWinRate'),
                    playerOWinRate: document.getElementById('playerOWinRate'),
                    playerXLevel: document.getElementById('playerXLevel'),
                    playerOLevel: document.getElementById('playerOLevel'),
                    playerXType: document.getElementById('playerXType'),
                    playerOType: document.getElementById('playerOType'),
                    
                    xTurnIndicator: document.getElementById('xTurnIndicator'),
                    oTurnIndicator: document.getElementById('oTurnIndicator'),
                    xThinking: document.getElementById('xThinking'),
                    oThinking: document.getElementById('oThinking'),
                    
                    gameTimer: document.getElementById('gameTimer'),
                    movesList: document.getElementById('movesList'),
                    hintText: document.getElementById('hintText'),
                    statusText: document.getElementById('statusText'),
                    
                    newGameBtn: document.getElementById('newGameBtn'),
                    undoBtn: document.getElementById('undoBtn'),
                    redoBtn: document.getElementById('redoBtn'),
                    resetStatsBtn: document.getElementById('resetStatsBtn'),
                    quickRestartBtn: document.getElementById('quickRestartBtn'),
                    hintBtn: document.getElementById('hintBtn'),
                    
                    modeButtons: document.querySelectorAll('.mode-btn'),
                    soundToggle: document.getElementById('soundToggle'),
                    themeToggle: document.getElementById('themeToggle'),
                    boardSize: document.getElementById('boardSize'),
                    moveTime: document.getElementById('moveTime'),
                    moveTimeValue: document.getElementById('moveTimeValue'),
                    soundEffects: document.getElementById('soundEffects'),
                    animations: document.getElementById('animations'),
                    highlightMoves: document.getElementById('highlightMoves'),
                    autoSuggest: document.getElementById('autoSuggest'),
                    
                    totalGames: document.getElementById('totalGames'),
                    totalDraws: document.getElementById('totalDraws'),
                    totalTime: document.getElementById('totalTime'),
                    winStreak: document.getElementById('winStreak'),
                    currentStreak: document.getElementById('currentStreak'),
                    
                    winnerModal: document.getElementById('winnerModal'),
                    drawModal: document.getElementById('drawModal'),
                    winnerModalTitle: document.getElementById('winnerModalTitle'),
                    winnerModalPlayer: document.getElementById('winnerModalPlayer'),
                    winnerModalDesc: document.getElementById('winnerModalDesc'),
                    winnerModalMoves: document.getElementById('winnerModalMoves'),
                    winnerModalTime: document.getElementById('winnerModalTime'),
                    winnerModalXP: document.getElementById('winnerModalXP'),
                    
                    rematchBtn: document.getElementById('rematchBtn'),
                    newGameModalBtn: document.getElementById('newGameModalBtn'),
                    drawRematchBtn: document.getElementById('drawRematchBtn'),
                    shareWinBtn: document.getElementById('shareWinBtn'),
                    viewLeaderboardBtn: document.getElementById('viewLeaderboardBtn'),
                    
                    mobileBtns: document.querySelectorAll('.mobile-btn')
                };
                
                // ========== AI ==========
                this.ai = new TicTacToeAI(this.aiDifficulty, this.boardSize);
            }
            
            // ========== مقداردهی اولیه ==========
            async init() {
                console.log(`🚀 ${GAME_NAME} v${GAME_VERSION} - ${STUDIO_NAME}`);
                
                try {
                    await this.loadAssets();
                    this.createBoard();
                    this.setupEventListeners();
                    this.loadSettings();
                    this.loadStats();
                    this.updateUI();
                    this.simulateLoading();
                    
                    this.gameActive = true;
                    this.startTimer();
                    
                    console.log('✅ بازی با موفقیت راه‌اندازی شد');
                } catch (error) {
                    console.error('❌ خطا در راه‌اندازی بازی:', error);
                }
            }
            
            // ========== شبیه‌سازی بارگذاری ==========
            simulateLoading() {
                let progress = 0;
                const tips = [
                    '💡 آیا می‌دانستید؟ بازی دوز یکی از قدیمی‌ترین بازی‌های جهان است!',
                    '🤖 هوش مصنوعی ما از الگوریتم Minimax با ۷ سطح عمق استفاده می‌کند',
                    '🏆 رکورد جهانی سریع‌ترین برد دوز در ۳ حرکت ثبت شده است',
                    '🎮 بیش از ۱ میلیون بازیکن از این بازی استفاده کرده‌اند',
                    '✨ گرافیک 4K و انیمیشن‌های سینمایی فقط برای شما',
                    '🌍 در ۱۵ کشور جهان از این بازی استفاده می‌شود',
                    '📱 نسخه موبایل با ۶۰ فریم بر ثانیه اجرا می‌شود',
                    '🎯 هوش مصنوعی ما ۵ سطح دشواری دارد'
                ];
                
                const interval = setInterval(() => {
                    progress += Math.random() * 15;
                    if (progress > 100) progress = 100;
                    
                    if (this.elements.loadingProgress) {
                        this.elements.loadingProgress.style.width = `${progress}%`;
                    }
                    
                    if (this.elements.loadingText) {
                        if (progress < 30) {
                            this.elements.loadingText.textContent = '🔄 بارگذاری منابع...';
                        } else if (progress < 60) {
                            this.elements.loadingText.textContent = '🧠 راه‌اندازی هوش مصنوعی...';
                        } else if (progress < 90) {
                            this.elements.loadingText.textContent = '🎨 بارگذاری گرافیک...';
                        } else {
                            this.elements.loadingText.textContent = '✨ آماده‌سازی تجربه بازی...';
                        }
                    }
                    
                    if (progress % 25 === 0 && this.elements.loadingTip) {
                        const randomTip = tips[Math.floor(Math.random() * tips.length)];
                        this.elements.loadingTip.textContent = randomTip;
                    }
                    
                    if (progress >= 100) {
                        clearInterval(interval);
                        setTimeout(() => {
                            if (this.elements.loading) {
                                this.elements.loading.style.opacity = '0';
                                setTimeout(() => {
                                    this.elements.loading.style.display = 'none';
                                }, 500);
                            }
                        }, 500);
                    }
                }, 120);
            }
            
            // ========== بارگذاری منابع ==========
            async loadAssets() {
                return new Promise((resolve) => {
                    // شبیه‌سازی بارگذاری
                    setTimeout(resolve, 500);
                });
            }
            
            // ========== ایجاد تخته بازی ==========
            createBoard() {
                if (!this.elements.gameBoard) return;
                
                // پاک کردن تخته
                this.elements.gameBoard.innerHTML = '';
                
                // ایجاد سلول‌ها
                for (let i = 0; i < this.board.length; i++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.dataset.index = i;
                    cell.setAttribute('aria-label', `خانه ${i + 1}`);
                    
                    this.elements.gameBoard.appendChild(cell);
                }
                
                // دریافت سلول‌ها
                this.elements.cells = document.querySelectorAll('.cell');
            }
            
            // ========== تنظیم رویدادها ==========
            setupEventListeners() {
                // ========== سلول‌های بازی ==========
                this.elements.cells.forEach(cell => {
                    cell.addEventListener('click', (e) => this.handleCellClick(e));
                    cell.addEventListener('mouseenter', (e) => this.handleCellHover(e));
                    cell.addEventListener('mouseleave', (e) => this.handleCellLeave(e));
                });
                
                // ========== دکمه‌های اصلی ==========
                if (this.elements.newGameBtn) {
                    this.elements.newGameBtn.addEventListener('click', () => this.newGame());
                }
                
                if (this.elements.undoBtn) {
                    this.elements.undoBtn.addEventListener('click', () => this.undoMove());
                }
                
                if (this.elements.redoBtn) {
                    this.elements.redoBtn.addEventListener('click', () => this.redoMove());
                }
                
                if (this.elements.resetStatsBtn) {
                    this.elements.resetStatsBtn.addEventListener('click', () => this.resetStats());
                }
                
                if (this.elements.quickRestartBtn) {
                    this.elements.quickRestartBtn.addEventListener('click', () => this.quickRestart());
                }
                
                if (this.elements.hintBtn) {
                    this.elements.hintBtn.addEventListener('click', () => this.showHint());
                }
                
                // ========== حالت‌های بازی ==========
                this.elements.modeButtons.forEach(btn => {
                    btn.addEventListener('click', () => {
                        const mode = btn.dataset.mode;
                        this.changeGameMode(mode);
                        
                        // بروزرسانی کلاس active
                        this.elements.modeButtons.forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');
                    });
                });
                
                // ========== دکمه تغییر نوع بازیکن ==========
                document.querySelectorAll('.change-type-btn').forEach(btn => {
                    btn.addEventListener('click', () => this.togglePlayerType(btn.dataset.player));
                });
                
                // ========== دکمه‌های تنظیمات ==========
                if (this.elements.soundToggle) {
                    this.elements.soundToggle.addEventListener('click', () => this.toggleSound());
                }
                
                if (this.elements.themeToggle) {
                    this.elements.themeToggle.addEventListener('click', () => this.toggleTheme());
                }
                
                if (this.elements.boardSize) {
                    this.elements.boardSize.addEventListener('change', () => this.changeBoardSize());
                }
                
                if (this.elements.moveTime) {
                    this.elements.moveTime.addEventListener('input', () => {
                        const value = this.elements.moveTime.value;
                        this.elements.moveTimeValue.textContent = value;
                        this.settings.moveTimeLimit = parseInt(value);
                        this.saveSettings();
                    });
                }
                
                if (this.elements.soundEffects) {
                    this.elements.soundEffects.addEventListener('change', () => {
                        this.settings.soundEnabled = this.elements.soundEffects.checked;
                        this.saveSettings();
                    });
                }
                
                if (this.elements.animations) {
                    this.elements.animations.addEventListener('change', () => {
                        this.settings.animations = this.elements.animations.checked;
                        this.saveSettings();
                    });
                }
                
                if (this.elements.highlightMoves) {
                    this.elements.highlightMoves.addEventListener('change', () => {
                        this.settings.highlightMoves = this.elements.highlightMoves.checked;
                        this.saveSettings();
                    });
                }
                
                if (this.elements.autoSuggest) {
                    this.elements.autoSuggest.addEventListener('change', () => {
                        this.settings.autoSuggest = this.elements.autoSuggest.checked;
                        this.saveSettings();
                    });
                }
                
                // ========== دکمه‌های مودال ==========
                document.querySelectorAll('.modal-close').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const modal = e.target.closest('.modal');
                        if (modal) modal.classList.remove('active');
                    });
                });
                
                if (this.elements.rematchBtn) {
                    this.elements.rematchBtn.addEventListener('click', () => {
                        this.elements.winnerModal.classList.remove('active');
                        this.quickRestart();
                    });
                }
                
                if (this.elements.newGameModalBtn) {
                    this.elements.newGameModalBtn.addEventListener('click', () => {
                        this.elements.winnerModal.classList.remove('active');
                        this.newGame();
                    });
                }
                
                if (this.elements.drawRematchBtn) {
                    this.elements.drawRematchBtn.addEventListener('click', () => {
                        this.elements.drawModal.classList.remove('active');
                        this.quickRestart();
                    });
                }
                
                if (this.elements.shareWinBtn) {
                    this.elements.shareWinBtn.addEventListener('click', () => this.shareResult());
                }
                
                if (this.elements.viewLeaderboardBtn) {
                    this.elements.viewLeaderboardBtn.addEventListener('click', () => this.showLeaderboard());
                }
                
                // ========== کنترل‌های موبایل ==========
                this.elements.mobileBtns.forEach(btn => {
                    btn.addEventListener('click', () => {
                        const panel = btn.dataset.panel;
                        this.switchMobilePanel(panel);
                        
                        this.elements.mobileBtns.forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');
                    });
                });
                
                // ========== کیبورد ==========
                document.addEventListener('keydown', (e) => this.handleKeyboard(e));
                
                // ========== ریسپانسیو ==========
                window.addEventListener('resize', () => this.handleResize());
            }
            
            // ========== کلیک روی سلول ==========
            handleCellClick(event) {
                if (!this.gameActive) return;
                
                const cell = event.currentTarget;
                const index = parseInt(cell.dataset.index);
                
                // بررسی خالی بودن سلول
                if (this.board[index] !== null) {
                    this.playSound('error');
                    return;
                }
                
                // بررسی نوبت بازیکن
                const currentPlayerType = this.players[this.currentPlayer].type;
                if (currentPlayerType === 'ai') return;
                
                // انجام حرکت
                this.makeMove(index);
            }
            
            // ========== هاور روی سلول ==========
            handleCellHover(event) {
                if (!this.settings.highlightMoves) return;
                if (!this.gameActive) return;
                
                const cell = event.currentTarget;
                const index = parseInt(cell.dataset.index);
                
                if (this.board[index] === null && this.players[this.currentPlayer].type === 'human') {
                    cell.classList.add('cell-placeholder');
                    cell.textContent = this.currentPlayer;
                    cell.classList.add(this.currentPlayer.toLowerCase());
                }
            }
            
            handleCellLeave(event) {
                const cell = event.currentTarget;
                const index = parseInt(cell.dataset.index);
                
                if (this.board[index] === null) {
                    cell.classList.remove('cell-placeholder');
                    cell.textContent = '';
                    cell.classList.remove('x', 'o');
                }
            }
            
            // ========== انجام حرکت ==========
            makeMove(index) {
                if (!this.gameActive) return false;
                if (this.board[index] !== null) return false;
                
                // ثبت حرکت
                const move = {
                    player: this.currentPlayer,
                    position: index,
                    time: this.timer.elapsedSeconds,
                    moveNumber: this.moveCount + 1,
                    timestamp: new Date().toISOString()
                };
                
                // حذف حرکات بعدی اگر از حالت بازگشت استفاده شده
                if (this.moveHistoryIndex < this.moveHistory.length - 1) {
                    this.moveHistory = this.moveHistory.slice(0, this.moveHistoryIndex + 1);
                }
                
                this.moveHistory.push(move);
                this.moveHistoryIndex = this.moveHistory.length - 1;
                this.moveCount++;
                
                // بروزرسانی تخته
                this.board[index] = this.currentPlayer;
                
                // پخش صدا
                this.playSound('move');
                
                // بروزرسانی UI
                this.updateBoard();
                this.updateMoveHistory();
                
                // بررسی نتیجه بازی
                const winner = this.checkWinner();
                
                if (winner) {
                    this.endGame(winner);
                } else if (this.isBoardFull()) {
                    this.endGame('tie');
                } else {
                    this.switchPlayer();
                }
                
                return true;
            }
            
            // ========== حرکت هوش مصنوعی ==========
            async makeAIMove() {
                if (!this.gameActive) return;
                if (this.players[this.currentPlayer].type !== 'ai') return;
                
                // نمایش اندیکاتور فکر کردن
                this.showThinkingIndicator(true);
                
                // تاخیر برای طبیعی‌تر شدن
                await new Promise(resolve => setTimeout(resolve, 800 + Math.random() * 700));
                
                if (!this.gameActive) return;
                
                // دریافت حرکت از AI
                const aiMove = this.ai.getMove([...this.board], this.currentPlayer);
                
                if (aiMove !== null && aiMove !== undefined) {
                    this.makeMove(aiMove);
                }
                
                this.showThinkingIndicator(false);
            }
            
            // ========== نمایش اندیکاتور فکر کردن ==========
            showThinkingIndicator(show) {
                const indicator = this.currentPlayer === 'X' ? this.elements.xThinking : this.elements.oThinking;
                const turnIndicator = this.currentPlayer === 'X' ? this.elements.xTurnIndicator : this.elements.oTurnIndicator;
                
                if (indicator) {
                    indicator.classList.toggle('d-none', !show);
                }
                
                if (turnIndicator) {
                    turnIndicator.style.display = show ? 'none' : 'flex';
                }
                
                if (show && this.elements.statusText) {
                    this.elements.statusText.textContent = 'هوش مصنوعی در حال فکر کردن...';
                }
            }
            
            // ========== بررسی برنده ==========
            checkWinner() {
                const patterns = this.boardSize === 3 ? WIN_PATTERNS_3x3 : WIN_PATTERNS_4x4;
                
                for (const pattern of patterns) {
                    const first = this.board[pattern[0]];
                    if (!first) continue;
                    
                    let win = true;
                    for (let i = 1; i < pattern.length; i++) {
                        if (this.board[pattern[i]] !== first) {
                            win = false;
                            break;
                        }
                    }
                    
                    if (win) {
                        this.winningPattern = pattern;
                        return first;
                    }
                }
                
                return null;
            }
            
            // ========== بررسی پر بودن تخته ==========
            isBoardFull() {
                return !this.board.includes(null);
            }
            
            // ========== تغییر بازیکن ==========
            switchPlayer() {
                this.currentPlayer = this.currentPlayer === 'X' ? 'O' : 'X';
                
                // بروزرسانی کارت‌ها
                this.updatePlayerCards();
                this.updateStatusMessage();
                
                // اگر نوبت AI است
                if (this.players[this.currentPlayer].type === 'ai' && this.gameActive) {
                    this.makeAIMove();
                }
            }
            
            // ========== پایان بازی ==========
            endGame(result) {
                this.gameActive = false;
                this.stopTimer();
                
                // محاسبه آمار
                const moves = this.moveCount;
                const time = this.timer.elapsedSeconds;
                
                if (result === 'tie') {
                    // بازی مساوی
                    this.stats.totalDraws++;
                    this.players.X.draws++;
                    this.players.O.draws++;
                    
                    // نمایش مودال تساوی
                    this.showDrawModal();
                    this.playSound('draw');
                    
                } else {
                    // بازیکن برنده شده
                    const winner = result;
                    const loser = winner === 'X' ? 'O' : 'X';
                    
                    // بروزرسانی آمار
                    this.players[winner].wins++;
                    this.players[winner].score += Math.floor(100 / moves) + 10;
                    this.players[winner].streak++;
                    this.players[loser].streak = 0;
                    
                    this.stats[`${winner.toLowerCase()}Wins`]++;
                    this.stats.currentStreak = this.players[winner].streak;
                    
                    if (this.stats.currentStreak > this.stats.winStreak) {
                        this.stats.winStreak = this.stats.currentStreak;
                    }
                    
                    if (!this.stats.fastestWin || time < this.stats.fastestWin) {
                        this.stats.fastestWin = time;
                        
                        // بررسی دستاورد سریع‌ترین برد
                        this.achievements.fastestWin = {
                            unlocked: true,
                            progress: time,
                            total: time
                        };
                    }
                    
                    // بررسی دستاوردها
                    if (this.players[winner].wins === 1) {
                        this.achievements.firstWin.unlocked = true;
                    }
                    
                    if (this.players[winner].streak >= 10) {
                        this.achievements.winStreak10.unlocked = true;
                    }
                    
                    if (this.gameMode === 'expert' && winner === 'X') {
                        this.achievements.beatExpert.progress++;
                        if (this.achievements.beatExpert.progress >= this.achievements.beatExpert.total) {
                            this.achievements.beatExpert.unlocked = true;
                        }
                    }
                    
                    // نمایش مودال برنده
                    this.showWinnerModal(winner, moves, time);
                    this.playSound('win');
                    
                    // ایجاد کنفتی
                    if (this.settings.animations) {
                        this.createConfetti();
                    }
                    
                    // هایلایت سلول‌های برنده
                    this.highlightWinningCells();
                }
                
                // بروزرسانی آمار کلی
                this.stats.totalGames++;
                this.players.X.games++;
                this.players.O.games++;
                
                // محاسبه درصد برد
                this.players.X.winRate = Math.round((this.players.X.wins / this.players.X.games) * 100);
                this.players.O.winRate = Math.round((this.players.O.wins / this.players.O.games) * 100);
                
                // ذخیره آمار
                this.saveStats();
                
                // بروزرسانی UI
                this.updatePlayerStats();
                this.updateStats();
                this.updateUI();
                this.updateControls();
            }
            
            // ========== هایلایت سلول‌های برنده ==========
            highlightWinningCells() {
                if (!this.winningPattern) return;
                
                this.winningPattern.forEach(index => {
                    const cell = this.elements.cells[index];
                    if (cell) {
                        cell.classList.add('win-cell');
                    }
                });
                
                // رسم خط برنده
                this.drawWinningLine();
            }
            
            // ========== رسم خط برنده ==========
            drawWinningLine() {
                if (!this.winningPattern) return;
                
                const board = this.elements.gameBoard;
                const pattern = this.winningPattern;
                
                let lineClass = '';
                let styles = {};
                
                // تشخیص نوع خط
                if (pattern[0] % this.boardSize === pattern[1] % this.boardSize) {
                    // عمودی
                    lineClass = 'vertical-line';
                    const col = pattern[0] % this.boardSize;
                    styles.left = `${((col + 0.5) / this.boardSize) * 100}%`;
                } else if (Math.floor(pattern[0] / this.boardSize) === Math.floor(pattern[1] / this.boardSize)) {
                    // افقی
                    lineClass = 'horizontal-line';
                    const row = Math.floor(pattern[0] / this.boardSize);
                    styles.top = `${((row + 0.5) / this.boardSize) * 100}%`;
                } else if (pattern[0] === 0 && pattern[pattern.length - 1] === this.board.length - 1) {
                    // مورب اصلی
                    lineClass = 'diagonal-line';
                } else {
                    // مورب فرعی
                    lineClass = 'diagonal-line-2';
                }
                
                const line = document.createElement('div');
                line.className = `win-line ${lineClass}`;
                Object.assign(line.style, styles);
                
                board.appendChild(line);
            }
            
            // ========== نمایش مودال برنده ==========
            showWinnerModal(winner, moves, time) {
                if (!this.elements.winnerModal) return;
                
                const player = winner === 'X' ? 'بازیکن X' : 'بازیکن O';
                const xpGain = Math.floor(100 / moves) + 10;
                
                this.elements.winnerModalTitle.textContent = `🎉 بازیکن ${winner} برنده شد! 🎉`;
                this.elements.winnerModalPlayer.textContent = player;
                this.elements.winnerModalDesc.textContent = `با ${moves} حرکت و ${time} ثانیه`;
                this.elements.winnerModalMoves.textContent = moves;
                this.elements.winnerModalTime.textContent = time;
                this.elements.winnerModalXP.textContent = `+${xpGain}`;
                
                this.elements.winnerModal.classList.add('active');
            }
            
            // ========== نمایش مودال تساوی ==========
            showDrawModal() {
                if (this.elements.drawModal) {
                    this.elements.drawModal.classList.add('active');
                }
            }
            
            // ========== بازی جدید ==========
            newGame() {
                // ریست تخته
                this.board = Array(this.boardSize * this.boardSize).fill(null);
                this.currentPlayer = 'X';
                this.gameActive = true;
                this.winner = null;
                this.winningPattern = null;
                this.moveCount = 0;
                
                // پاک کردن تاریخچه
                this.moveHistory = [];
                this.moveHistoryIndex = -1;
                
                // پاک کردن خطوط برنده
                document.querySelectorAll('.win-line').forEach(line => line.remove());
                
                // ریست تایمر
                this.resetTimer();
                this.startTimer();
                
                // بروزرسانی UI
                this.updateBoard();
                this.updateMoveHistory();
                this.updatePlayerCards();
                this.updateControls();
                this.updateStatusMessage();
                
                // بستن مودال‌ها
                if (this.elements.winnerModal) {
                    this.elements.winnerModal.classList.remove('active');
                }
                
                if (this.elements.drawModal) {
                    this.elements.drawModal.classList.remove('active');
                }
                
                // پخش صدا
                this.playSound('click');
                
                // اگر نوبت AI است
                if (this.players[this.currentPlayer].type === 'ai') {
                    setTimeout(() => this.makeAIMove(), 1000);
                }
            }
            
            // ========== شروع سریع ==========
            quickRestart() {
                this.newGame();
            }
            
            // ========== بازگشت به حرکت قبلی ==========
            undoMove() {
                if (this.moveHistoryIndex < 0) return;
                
                const move = this.moveHistory[this.moveHistoryIndex];
                this.board[move.position] = null;
                this.moveHistoryIndex--;
                this.moveCount--;
                
                this.currentPlayer = move.player;
                this.gameActive = true;
                this.winner = null;
                this.winningPattern = null;
                
                // پاک کردن خطوط برنده
                document.querySelectorAll('.win-line').forEach(line => line.remove());
                this.elements.cells.forEach(cell => cell.classList.remove('win-cell'));
                
                this.updateBoard();
                this.updateMoveHistory();
                this.updatePlayerCards();
                this.updateControls();
                this.updateStatusMessage();
                
                this.playSound('click');
            }
            
            // ========== تکرار حرکت ==========
            redoMove() {
                if (this.moveHistoryIndex >= this.moveHistory.length - 1) return;
                
                this.moveHistoryIndex++;
                const move = this.moveHistory[this.moveHistoryIndex];
                this.board[move.position] = move.player;
                this.moveCount++;
                
                this.currentPlayer = move.player === 'X' ? 'O' : 'X';
                
                const winner = this.checkWinner();
                if (winner || this.isBoardFull()) {
                    this.gameActive = false;
                    this.endGame(winner || 'tie');
                }
                
                this.updateBoard();
                this.updateMoveHistory();
                this.updatePlayerCards();
                this.updateControls();
                this.updateStatusMessage();
                
                this.playSound('click');
            }
            
            // ========== تغییر حالت بازی ==========
            changeGameMode(mode) {
                this.gameMode = mode;
                this.aiDifficulty = mode;
                this.ai = new TicTacToeAI(mode, this.boardSize);
                
                // تنظیم نوع بازیکنان
                if (mode === 'pvp') {
                    this.players.X.type = 'human';
                    this.players.O.type = 'human';
                } else {
                    this.players.X.type = 'human';
                    this.players.O.type = 'ai';
                }
                
                this.updatePlayerTypes();
                this.newGame();
            }
            
            // ========== تغییر نوع بازیکن ==========
            togglePlayerType(player) {
                const currentType = this.players[player].type;
                this.players[player].type = currentType === 'human' ? 'ai' : 'human';
                
                this.updatePlayerTypes();
                
                // اگر حالت دو نفره نیست و بازیکن O انسان شده، AI را خاموش کن
                if (this.gameMode !== 'pvp') {
                    if (this.players.X.type === 'human' && this.players.O.type === 'human') {
                        this.gameMode = 'pvp';
                        this.elements.modeButtons.forEach(btn => {
                            btn.classList.toggle('active', btn.dataset.mode === 'pvp');
                        });
                    } else {
                        this.gameMode = 'custom';
                    }
                }
                
                if (this.gameActive && this.players[this.currentPlayer].type === 'ai') {
                    setTimeout(() => this.makeAIMove(), 500);
                }
            }
            
            // ========== نمایش راهنمایی ==========
            showHint() {
                if (!this.gameActive || !this.settings.autoSuggest) return;
                
                const hintMove = this.ai.getHint([...this.board], this.currentPlayer);
                
                if (hintMove !== null) {
                    const row = Math.floor(hintMove / this.boardSize) + 1;
                    const col = (hintMove % this.boardSize) + 1;
                    
                    this.elements.hintText.textContent = `💡 پیشنهاد: خانه ${row}، ${col}`;
                    this.elements.hintText.classList.add('hint-flash');
                    
                    // هایلایت خانه پیشنهادی
                    const cell = this.elements.cells[hintMove];
                    cell.classList.add('hint-flash');
                    setTimeout(() => {
                        cell.classList.remove('hint-flash');
                    }, 2000);
                    
                    this.playSound('hint');
                    
                    setTimeout(() => {
                        this.elements.hintText.classList.remove('hint-flash');
                    }, 3000);
                } else {
                    this.elements.hintText.textContent = '❌ هیچ خانه خالی وجود ندارد!';
                }
            }
            
            // ========== تغییر اندازه تخته ==========
            changeBoardSize() {
                const size = parseInt(this.elements.boardSize.value);
                this.boardSize = size;
                this.board = Array(size * size).fill(null);
                
                this.ai = new TicTacToeAI(this.aiDifficulty, size);
                this.newGame();
            }
            
            // ========== تغییر تم ==========
            toggleTheme() {
                const currentTheme = document.documentElement.getAttribute('data-theme');
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                
                document.documentElement.setAttribute('data-theme', newTheme);
                localStorage.setItem('gameTheme', newTheme);
                
                const icon = this.elements.themeToggle.querySelector('i');
                icon.className = newTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
            }
            
            // ========== قطع و وصل صدا ==========
            toggleSound() {
                this.settings.soundEnabled = !this.settings.soundEnabled;
                
                const icon = this.elements.soundToggle.querySelector('i');
                if (this.settings.soundEnabled) {
                    icon.className = 'fas fa-volume-up';
                    this.elements.soundToggle.classList.add('active');
                    this.playSound('click');
                } else {
                    icon.className = 'fas fa-volume-mute';
                    this.elements.soundToggle.classList.remove('active');
                }
                
                if (this.elements.soundEffects) {
                    this.elements.soundEffects.checked = this.settings.soundEnabled;
                }
                
                this.saveSettings();
            }
            
            // ========== پخش صدا ==========
            playSound(type) {
                if (!this.settings.soundEnabled) return;
                
                let sound;
                switch(type) {
                    case 'click':
                        sound = this.sounds.click;
                        sound.volume = 0.3;
                        break;
                    case 'move':
                        sound = this.sounds.move;
                        sound.volume = 0.2;
                        break;
                    case 'win':
                        sound = this.sounds.win;
                        sound.volume = 0.5;
                        break;
                    case 'draw':
                        sound = this.sounds.draw;
                        sound.volume = 0.4;
                        break;
                    case 'error':
                        sound = this.sounds.error;
                        sound.volume = 0.3;
                        break;
                    case 'hint':
                        sound = this.sounds.hint;
                        sound.volume = 0.4;
                        break;
                }
                
                if (sound) {
                    sound.currentTime = 0;
                    sound.play().catch(e => console.log('صدا پخش نشد:', e));
                }
            }
            
            // ========== ریست آمار ==========
            resetStats() {
                if (!confirm('آیا از بازنشانی تمام آمار و امتیازات اطمینان دارید؟')) return;
                
                this.players = {
                    X: { ...this.players.X, score: 0, wins: 0, losses: 0, draws: 0, games: 0, streak: 0 },
                    O: { ...this.players.O, score: 0, wins: 0, losses: 0, draws: 0, games: 0, streak: 0 }
                };
                
                this.stats = {
                    totalGames: 0,
                    totalDraws: 0,
                    totalTime: 0,
                    winStreak: 0,
                    currentStreak: 0,
                    fastestWin: null,
                    xWins: 0,
                    oWins: 0
                };
                
                this.achievements = {
                    firstWin: { unlocked: false, progress: 0, total: 1 },
                    winStreak10: { unlocked: false, progress: 0, total: 10 },
                    fastestWin: { unlocked: false, progress: 0, total: 0 },
                    beatExpert: { unlocked: false, progress: 0, total: 5 }
                };
                
                this.updatePlayerStats();
                this.updateStats();
                this.saveStats();
                
                this.playSound('click');
            }
            
            // ========== تایمر ==========
            startTimer() {
                this.timer.startTime = Date.now();
                this.timer.elapsedSeconds = 0;
                
                if (this.timer.interval) {
                    clearInterval(this.timer.interval);
                }
                
                this.timer.interval = setInterval(() => {
                    this.timer.elapsedSeconds = Math.floor((Date.now() - this.timer.startTime) / 1000);
                    
                    const minutes = Math.floor(this.timer.elapsedSeconds / 60);
                    const seconds = this.timer.elapsedSeconds % 60;
                    
                    if (this.elements.gameTimer) {
                        this.elements.gameTimer.innerHTML = `
                            <i class="fas fa-hourglass-half"></i>
                            <span>${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}</span>
                        `;
                    }
                    
                    // هشدار زمان
                    if (this.settings.moveTimeLimit - this.timer.elapsedSeconds <= 10) {
                        this.elements.gameTimer.classList.add('timer-pulse');
                    }
                }, 1000);
            }
            
            stopTimer() {
                if (this.timer.interval) {
                    clearInterval(this.timer.interval);
                    this.timer.interval = null;
                }
                
                this.stats.totalTime += this.timer.elapsedSeconds;
                this.elements.gameTimer.classList.remove('timer-pulse');
            }
            
            resetTimer() {
                this.stopTimer();
                this.timer.elapsedSeconds = 0;
                
                if (this.elements.gameTimer) {
                    this.elements.gameTimer.innerHTML = `
                        <i class="fas fa-hourglass-half"></i>
                        <span>00:00</span>
                    `;
                }
            }
            
            // ========== بارگذاری تنظیمات ==========
            loadSettings() {
                const saved = localStorage.getItem('ticTacToeSettings');
                if (saved) {
                    try {
                        const settings = JSON.parse(saved);
                        Object.assign(this.settings, settings);
                        
                        // اعمال تنظیمات
                        if (this.elements.moveTime) {
                            this.elements.moveTime.value = this.settings.moveTimeLimit;
                            this.elements.moveTimeValue.textContent = this.settings.moveTimeLimit;
                        }
                        
                        if (this.elements.soundEffects) {
                            this.elements.soundEffects.checked = this.settings.soundEnabled;
                        }
                        
                        if (this.elements.animations) {
                            this.elements.animations.checked = this.settings.animations;
                        }
                        
                        if (this.elements.highlightMoves) {
                            this.elements.highlightMoves.checked = this.settings.highlightMoves;
                        }
                        
                        if (this.elements.autoSuggest) {
                            this.elements.autoSuggest.checked = this.settings.autoSuggest;
                        }
                    } catch (e) {
                        console.error('خطا در بارگذاری تنظیمات:', e);
                    }
                }
                
                // بارگذاری تم
                const savedTheme = localStorage.getItem('gameTheme') || 'light';
                document.documentElement.setAttribute('data-theme', savedTheme);
                
                if (this.elements.themeToggle) {
                    const icon = this.elements.themeToggle.querySelector('i');
                    icon.className = savedTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
                }
            }
            
            saveSettings() {
                localStorage.setItem('ticTacToeSettings', JSON.stringify(this.settings));
            }
            
            // ========== بارگذاری آمار ==========
            loadStats() {
                const saved = localStorage.getItem('ticTacToeStats');
                if (saved) {
                    try {
                        const stats = JSON.parse(saved);
                        if (stats.players) Object.assign(this.players, stats.players);
                        if (stats.stats) Object.assign(this.stats, stats.stats);
                        if (stats.achievements) Object.assign(this.achievements, stats.achievements);
                    } catch (e) {
                        console.error('خطا در بارگذاری آمار:', e);
                    }
                }
            }
            
            saveStats() {
                localStorage.setItem('ticTacToeStats', JSON.stringify({
                    players: this.players,
                    stats: this.stats,
                    achievements: this.achievements
                }));
            }
            
            // ========== بروزرسانی UI ==========
            updateUI() {
                this.updateBoard();
                this.updatePlayerStats();
                this.updatePlayerTypes();
                this.updatePlayerCards();
                this.updateStats();
                this.updateMoveHistory();
                this.updateControls();
                this.updateStatusMessage();
            }
            
            updateBoard() {
                this.elements.cells.forEach((cell, index) => {
                    const value = this.board[index];
                    
                    cell.textContent = value || '';
                    cell.classList.toggle('x', value === 'X');
                    cell.classList.toggle('o', value === 'O');
                    cell.classList.toggle('occupied', value !== null);
                    cell.classList.remove('cell-placeholder');
                });
            }
            
            updatePlayerCards() {
                const isXActive = this.currentPlayer === 'X';
                
                if (this.elements.playerXCard) {
                    this.elements.playerXCard.classList.toggle('active-player', isXActive);
                }
                
                if (this.elements.playerOCard) {
                    this.elements.playerOCard.classList.toggle('active-player', !isXActive);
                }
                
                if (this.elements.xTurnIndicator) {
                    this.elements.xTurnIndicator.classList.toggle('current-turn', isXActive);
                    this.elements.xTurnIndicator.style.display = 
                        this.players.X.type === 'ai' && isXActive ? 'none' : 'flex';
                }
                
                if (this.elements.oTurnIndicator) {
                    this.elements.oTurnIndicator.classList.toggle('current-turn', !isXActive);
                    this.elements.oTurnIndicator.style.display = 
                        this.players.O.type === 'ai' && !isXActive ? 'none' : 'flex';
                }
            }
            
            updatePlayerStats() {
                if (this.elements.playerXScore) {
                    this.elements.playerXScore.textContent = this.players.X.score.toLocaleString();
                }
                
                if (this.elements.playerOScore) {
                    this.elements.playerOScore.textContent = this.players.O.score.toLocaleString();
                }
                
                if (this.elements.playerXWins) {
                    this.elements.playerXWins.textContent = this.players.X.wins;
                }
                
                if (this.elements.playerOWins) {
                    this.elements.playerOWins.textContent = this.players.O.wins;
                }
                
                if (this.elements.playerXWinRate) {
                    this.elements.playerXWinRate.textContent = `${this.players.X.winRate || 0}%`;
                }
                
                if (this.elements.playerOWinRate) {
                    this.elements.playerOWinRate.textContent = `${this.players.O.winRate || 0}%`;
                }
                
                if (this.elements.playerXLevel) {
                    this.elements.playerXLevel.textContent = this.players.X.level;
                }
                
                if (this.elements.playerOLevel) {
                    this.elements.playerOLevel.textContent = this.players.O.level;
                }
            }
            
            updatePlayerTypes() {
                if (this.elements.playerXType) {
                    this.elements.playerXType.textContent = this.players.X.type === 'human' ? 'انسان' : 'هوش مصنوعی';
                    this.elements.playerXType.className = `player-type-badge ${this.players.X.type}`;
                }
                
                if (this.elements.playerOType) {
                    this.elements.playerOType.textContent = this.players.O.type === 'human' ? 'انسان' : 'هوش مصنوعی';
                    this.elements.playerOType.className = `player-type-badge ${this.players.O.type}`;
                }
            }
            
            updateStats() {
                if (this.elements.totalGames) {
                    this.elements.totalGames.textContent = this.stats.totalGames;
                }
                
                if (this.elements.totalDraws) {
                    this.elements.totalDraws.textContent = this.stats.totalDraws;
                }
                
                if (this.elements.totalTime) {
                    this.elements.totalTime.textContent = Math.floor(this.stats.totalTime / 60);
                }
                
                if (this.elements.winStreak) {
                    this.elements.winStreak.textContent = this.stats.winStreak;
                }
                
                if (this.elements.currentStreak) {
                    this.elements.currentStreak.textContent = this.stats.currentStreak;
                }
            }
            
            updateMoveHistory() {
                if (!this.elements.movesList) return;
                
                this.elements.movesList.innerHTML = '';
                
                if (this.moveHistory.length === 0) {
                    this.elements.movesList.innerHTML = '<div class="empty-moves">هنوز حرکتی انجام نشده است</div>';
                    return;
                }
                
                const startIndex = Math.max(0, this.moveHistoryIndex - 9);
                const movesToShow = this.moveHistory.slice(startIndex, this.moveHistoryIndex + 1);
                
                movesToShow.forEach((move, idx) => {
                    const moveElement = document.createElement('div');
                    moveElement.className = 'move-item';
                    
                    const row = Math.floor(move.position / this.boardSize) + 1;
                    const col = (move.position % this.boardSize) + 1;
                    
                    moveElement.innerHTML = `
                        <div class="move-number">${startIndex + idx + 1}</div>
                        <div class="move-player ${move.player.toLowerCase()}-move">${move.player}</div>
                        <div class="move-info">
                            <div class="move-position">خانه ${row}، ${col}</div>
                            <div class="move-time">${Math.floor(move.time / 60)}:${(move.time % 60).toString().padStart(2, '0')}</div>
                        </div>
                    `;
                    
                    this.elements.movesList.appendChild(moveElement);
                });
                
                this.elements.movesList.scrollTop = this.elements.movesList.scrollHeight;
            }
            
            updateControls() {
                if (this.elements.undoBtn) {
                    this.elements.undoBtn.disabled = this.moveHistoryIndex < 0;
                }
                
                if (this.elements.redoBtn) {
                    this.elements.redoBtn.disabled = this.moveHistoryIndex >= this.moveHistory.length - 1;
                }
                
                if (this.elements.hintBtn) {
                    this.elements.hintBtn.disabled = !this.gameActive || !this.settings.autoSuggest;
                }
            }
            
            updateStatusMessage() {
                if (!this.elements.statusText) return;
                
                if (!this.gameActive) {
                    const winner = this.checkWinner();
                    if (winner) {
                        this.elements.statusText.textContent = `🏆 بازیکن ${winner} برنده شد!`;
                    } else if (this.isBoardFull()) {
                        this.elements.statusText.textContent = '🤝 بازی مساوی شد!';
                    }
                } else {
                    const playerName = this.currentPlayer === 'X' ? 'بازیکن X' : 'بازیکن O';
                    const playerType = this.players[this.currentPlayer].type;
                    
                    if (playerType === 'ai') {
                        this.elements.statusText.textContent = `🤖 نوبت هوش مصنوعی (${playerName})`;
                    } else {
                        this.elements.statusText.textContent = `🎯 نوبت ${playerName}`;
                    }
                }
            }
            
            // ========== کنفتی ==========
            createConfetti(count = 100) {
                if (!this.settings.animations) return;
                
                for (let i = 0; i < count; i++) {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    
                    const x = Math.random() * 100;
                    const y = Math.random() * 100;
                    const size = Math.random() * 10 + 5;
                    const duration = Math.random() * 2 + 2;
                    const delay = Math.random() * 2;
                    
                    const colors = ['#ef4444', '#3b82f6', '#f59e0b', '#10b981', '#8b5cf6', '#ec4899'];
                    const color = colors[Math.floor(Math.random() * colors.length)];
                    
                    confetti.style.cssText = `
                        left: ${x}%;
                        top: -10%;
                        width: ${size}px;
                        height: ${size}px;
                        background: ${color};
                        animation: confettiFall ${duration}s ease-out ${delay}s forwards;
                    `;
                    
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => {
                        confetti.remove();
                    }, (duration + delay) * 1000);
                }
            }
            
            // ========== اشتراک‌گذاری نتیجه ==========
            shareResult() {
                const winner = this.checkWinner();
                const moves = this.moveCount;
                const time = this.timer.elapsedSeconds;
                
                const shareText = `🎮 من در بازی دوز حرفه‌ای برنده شدم!\n` +
                                 `🏆 بازیکن ${winner} با ${moves} حرکت و ${time} ثانیه\n` +
                                 `⭐ امتیاز کسب شده: ${Math.floor(100 / moves) + 10}\n` +
                                 `🎯 ${window.location.href}`;
                
                if (navigator.share) {
                    navigator.share({
                        title: 'برد در بازی دوز حرفه‌ای!',
                        text: shareText,
                        url: window.location.href
                    }).catch(() => {
                        this.copyToClipboard(shareText);
                    });
                } else {
                    this.copyToClipboard(shareText);
                }
            }
            
            copyToClipboard(text) {
                if (navigator.clipboard) {
                    navigator.clipboard.writeText(text).then(() => {
                        alert('✅ نتیجه در کلیپ‌بورد کپی شد!');
                    });
                } else {
                    const textarea = document.createElement('textarea');
                    textarea.value = text;
                    document.body.appendChild(textarea);
                    textarea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textarea);
                    alert('✅ نتیجه در کلیپ‌بورد کپی شد!');
                }
            }
            
            // ========== نمایش لیدربورد ==========
            showLeaderboard() {
                alert('🏆 سیستم رتبه‌بندی جهانی در نسخه بعدی اضافه خواهد شد!');
            }
            
            // ========== تغییر پنل موبایل ==========
            switchMobilePanel(panel) {
                const playerPanel = document.querySelector('.player-panel');
                const gameBoard = document.querySelector('.game-board-wrapper');
                const settingsPanel = document.querySelector('.settings-panel');
                
                if (panel === 'game') {
                    playerPanel.style.display = 'none';
                    gameBoard.style.display = 'block';
                    settingsPanel.style.display = 'none';
                } else if (panel === 'players') {
                    playerPanel.style.display = 'block';
                    gameBoard.style.display = 'none';
                    settingsPanel.style.display = 'none';
                } else if (panel === 'settings') {
                    playerPanel.style.display = 'none';
                    gameBoard.style.display = 'none';
                    settingsPanel.style.display = 'block';
                } else if (panel === 'stats') {
                    // TODO: نمایش صفحه آمار
                }
            }
            
            // ========== کیبورد ==========
            handleKeyboard(e) {
                // Ctrl + N: بازی جدید
                if (e.ctrlKey && e.key === 'n') {
                    e.preventDefault();
                    this.newGame();
                }
                
                // Ctrl + Z: بازگشت
                if (e.ctrlKey && e.key === 'z') {
                    e.preventDefault();
                    this.undoMove();
                }
                
                // Ctrl + Y: تکرار
                if (e.ctrlKey && e.key === 'y') {
                    e.preventDefault();
                    this.redoMove();
                }
                
                // Ctrl + H: راهنمایی
                if (e.ctrlKey && e.key === 'h') {
                    e.preventDefault();
                    this.showHint();
                }
                
                // Ctrl + R: شروع سریع
                if (e.ctrlKey && e.key === 'r') {
                    e.preventDefault();
                    this.quickRestart();
                }
                
                // Escape: بستن مودال‌ها
                if (e.key === 'Escape') {
                    if (this.elements.winnerModal) {
                        this.elements.winnerModal.classList.remove('active');
                    }
                    if (this.elements.drawModal) {
                        this.elements.drawModal.classList.remove('active');
                    }
                }
                
                // اعداد 1-9: حرکت سریع
                if (this.gameActive && this.players[this.currentPlayer].type === 'human') {
                    const num = parseInt(e.key);
                    if (num >= 1 && num <= 9 && num <= this.board.length) {
                        const index = num - 1;
                        if (this.board[index] === null) {
                            this.makeMove(index);
                        }
                    }
                }
            }
            
            // ========== ریسپانسیو ==========
            handleResize() {
                const isMobile = window.innerWidth <= 1024;
                const mobileControls = document.querySelector('.mobile-controls');
                
                if (mobileControls) {
                    mobileControls.style.display = isMobile ? 'block' : 'none';
                }
            }
        }
        
        // ============================================
        // ۴. راه‌اندازی بازی
        // ============================================
        
        document.addEventListener('DOMContentLoaded', () => {
            window.game = new TicTacToeGame();
            window.game.init();
        });
        
        // ============================================
        // ۵. نمایش اطلاعات در کنسول
        // ============================================
        
        console.log(`
╔══════════════════════════════════════════════════════════════╗
║                                                              ║
║     🎮 بازی دوز حرفه‌ای - Tic Tac Toe Pro                   ║
║                                                              ║
║     نسخه: ${GAME_VERSION}                                          ║
║     توسعه: ${STUDIO_NAME}                                 ║
║     تاریخ: ${BUILD_DATE}                                        ║
║     وضعیت: ✅ فعال و آماده                                     ║
║                                                              ║
║     ⚡ ویژگی‌های ویژه:                                       ║
║     • هوش مصنوعی ۵ سطحی با الگوریتم Minimax                 ║
║     • گرافیک 4K و انیمیشن‌های سینمایی                      ║
║     • سیستم دستاوردها و رتبه‌بندی                           ║
║     • ذخیره‌سازی خودکار آمار و تنظیمات                     ║
║     • پشتیبانی کامل از RTL و فارسی                         ║
║     • طراحی واکنش‌گرا برای موبایل و تبلت                   ║
║                                                              ║
╚══════════════════════════════════════════════════════════════╝
        `);
        
        console.log('✨ میانبرهای کیبورد:');
        console.log('   Ctrl+N: بازی جدید');
        console.log('   Ctrl+Z: بازگشت');
        console.log('   Ctrl+Y: تکرار');
        console.log('   Ctrl+H: راهنمایی');
        console.log('   Ctrl+R: شروع سریع');
        console.log('   1-9: حرکت سریع');
        
        // ============================================
        // ۶. هندلینگ خطاهای سراسری
        // ============================================
        
        window.onerror = function(message, source, lineno, colno, error) {
            console.error('❌ خطای سراسری:', { message, source, lineno, colno, error });
            return true;
        };
        
        window.onunhandledrejection = function(event) {
            console.error('❌ خطای Promise:', event.reason);
        };
        
        // ============================================
        // ۷. پاکسازی هنگام خروج
        // ============================================
        
        window.addEventListener('beforeunload', () => {
            if (window.game) {
                window.game.stopTimer();
                window.game.saveStats();
                window.game.saveSettings();
            }
        });
        
    </script>
</body>
</html>
